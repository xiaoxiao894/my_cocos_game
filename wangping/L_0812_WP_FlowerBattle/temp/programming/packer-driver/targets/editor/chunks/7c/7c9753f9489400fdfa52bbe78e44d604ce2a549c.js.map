{"version":3,"sources":["file:///D:/Cocos/PlayAble/L_0812_WP_FlowerBattle/assets/JavaScript/Entitys/Blood.ts"],"names":["_decorator","Component","ProgressBar","tween","App","GlobeVariable","ccclass","property","Blood","_bloodMax","_bloodNow","init","blood","redProgress","progress","greenProgress","injuryAni","harm","Math","max","targetProgress","to","easing","call","recycleSelf","start","node","active","removeFromParent","poolManager","returnNode","entifyName","BloodBar"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;;AACpCC,MAAAA,G,iBAAAA,G;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;;;AAET;AACA;AACA;OACM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;yBAETQ,K,WADpBF,OAAO,CAAC,OAAD,C,UAEHC,QAAQ,CAACL,WAAD,C,UAGRK,QAAQ,CAACL,WAAD,C,2BALb,MACqBM,KADrB,SACmCP,SADnC,CAC6C;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOjCQ,SAPiC,GAOd,GAPc;AAAA,eAQjCC,SARiC,GAQd,GARc;AAAA;;AAUzC;AACJ;AACA;AACA;AACWC,QAAAA,IAAI,CAACC,KAAD,EAAc;AACrB,eAAKH,SAAL,GAAiBG,KAAjB;AACA,eAAKF,SAAL,GAAiBE,KAAjB;AACA,eAAKC,WAAL,CAAiBC,QAAjB,GAA4B,CAA5B;AACA,eAAKC,aAAL,CAAmBD,QAAnB,GAA8B,CAA9B;AACH;AAED;AACJ;AACA;AACA;;;AACWE,QAAAA,SAAS,CAACC,IAAD,EAAa;AACzB,eAAKP,SAAL,GAAiBQ,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY,KAAKT,SAAL,GAAiBO,IAA7B,CAAjB;AACA,gBAAMG,cAAc,GAAG,KAAKV,SAAL,GAAiB,KAAKD,SAA7C;AACA,eAAKI,WAAL,CAAiBC,QAAjB,GAA4BM,cAA5B;AACAjB,UAAAA,KAAK,CAAC,KAAKY,aAAN,CAAL,CACKM,EADL,CACQ,GADR,EACa;AAAEP,YAAAA,QAAQ,EAAEM;AAAZ,WADb,EAC2C;AAAEE,YAAAA,MAAM,EAAE;AAAV,WAD3C,EAEKC,IAFL,CAEU,MAAI;AACN,gBAAG,KAAKb,SAAL,IAAkB,CAArB,EAAuB;AACnB,mBAAKc,WAAL;AACH;AACJ,WANL,EAOKC,KAPL;AAQH;AAED;;;AACQD,QAAAA,WAAW,GAAE;AACjB,eAAKE,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACA,eAAKD,IAAL,CAAUE,gBAAV;AACA;AAAA;AAAA,0BAAIC,WAAJ,CAAgBC,UAAhB,CAA2B,KAAKJ,IAAhC,EAAsC;AAAA;AAAA,8CAAcK,UAAd,CAAyBC,QAA/D;AACH;;AA5CwC,O;;;;;iBAEf,I;;;;;;;iBAGE,I","sourcesContent":["import { _decorator, Component, ProgressBar, tween } from \"cc\";\r\nimport { App } from \"../App\";\r\nimport { GlobeVariable } from \"../core/GlobeVariable\";\r\n\r\n/**\r\n * 怪的血量控制\r\n */\r\nconst { ccclass, property } = _decorator;\r\n@ccclass(\"Blood\")\r\nexport default class Blood extends Component {\r\n    @property(ProgressBar)\r\n    redProgress:ProgressBar = null;\r\n\r\n    @property(ProgressBar)\r\n    greenProgress:ProgressBar = null;\r\n\r\n    private _bloodMax:number = 100;\r\n    private _bloodNow:number = 100;\r\n\r\n    /**\r\n     * 初始化\r\n     * @param blood 总血量\r\n     */\r\n    public init(blood:number){\r\n        this._bloodMax = blood;\r\n        this._bloodNow = blood;\r\n        this.redProgress.progress = 1;\r\n        this.greenProgress.progress = 1;\r\n    }\r\n\r\n    /**\r\n     * 受伤掉血\r\n     * @param harm 伤害值\r\n     */\r\n    public injuryAni(harm:number){\r\n        this._bloodNow = Math.max(0, this._bloodNow - harm);\r\n        const targetProgress = this._bloodNow / this._bloodMax;\r\n        this.redProgress.progress = targetProgress;\r\n        tween(this.greenProgress)\r\n            .to(0.5, { progress: targetProgress }, { easing: 'quadInOut' })\r\n            .call(()=>{\r\n                if(this._bloodNow <= 0){\r\n                    this.recycleSelf();\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n\r\n    /** 回收自己 */\r\n    private recycleSelf(){\r\n        this.node.active = false;\r\n        this.node.removeFromParent();\r\n        App.poolManager.returnNode(this.node, GlobeVariable.entifyName.BloodBar);\r\n    }\r\n}"]}