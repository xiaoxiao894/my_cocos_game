{"version":3,"sources":["file:///D:/Cocos/PlayAble/L_0812_WP_FlowerBattle/assets/JavaScript/Entitys/BeetleController.ts"],"names":["BeetleController","tween","Vec3","App","GlobeVariable","PlayerBeetle","beetleList","Instance","_instance","init","creatBeetleByLevel","beetleCurNum","beetleNumLimit","realCreatBeetle","sceneNode","beetleBirthPos","worldPosition","clone","getBeetleList","removeBeetle","beetle","index","indexOf","splice","length","beetleIsMoveEnemy","console","log","pos","prefab","poolManager","getNode","entifyName","Beetle","parent","beetleParent","setWorldPosition","active","getComponent","push","to","scale","easing","start","update","dt","enemy"],"mappings":"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","sourcesContent":["import { _decorator, Node, tween, Vec3 } from 'cc';\r\nimport { App } from '../App';\r\nimport { GlobeVariable } from '../core/GlobeVariable';\r\nimport { PlayerBeetle } from './PlayerBeetle';\r\nexport class BeetleController {\r\n\r\n    private beetleList: PlayerBeetle[] = [];//冲锋甲虫列表\r\n\r\n    public static _instance: BeetleController = null;\r\n\r\n    public static get Instance() {\r\n        if (this._instance == null) {\r\n            this._instance = new BeetleController();\r\n        }\r\n        return this._instance;\r\n    }\r\n    public init() {\r\n\r\n    }\r\n    //n级敌人随机出现的位置\r\n    public creatBeetleByLevel() {\r\n\r\n        if (GlobeVariable.beetleCurNum >= GlobeVariable.beetleNumLimit) {\r\n            return;\r\n        }\r\n        this.realCreatBeetle(App.sceneNode.beetleBirthPos.worldPosition.clone());\r\n    }\r\n\r\n    getBeetleList() {\r\n        return this.beetleList;\r\n    }\r\n\r\n    public removeBeetle(beetle: PlayerBeetle) {\r\n\r\n        const index = this.beetleList.indexOf(beetle);\r\n        if (index !== -1) {\r\n            this.beetleList.splice(index, 1); // 从列表中移除\r\n        }\r\n        if (this.beetleList.length <= 0) {\r\n            GlobeVariable.beetleIsMoveEnemy = false;\r\n            \r\n        }\r\n        console.log(`remove enemy ,num ${this.beetleList.length}`);\r\n    }\r\n    /** 真正创建怪 */\r\n    private realCreatBeetle(pos: Vec3) {\r\n        GlobeVariable.beetleCurNum++;\r\n\r\n        let prefab = App.poolManager.getNode(GlobeVariable.entifyName.Beetle);\r\n        prefab.parent = App.sceneNode.beetleParent;\r\n        prefab.setWorldPosition(pos);//init里用到了位置，放init前边\r\n        prefab.active = true;\r\n        let beetle = prefab.getComponent(PlayerBeetle);\r\n\r\n        this.beetleList.push(beetle);\r\n        console.log(`push beetle ,num ${this.beetleList.length}`);\r\n\r\n        //出现动画\r\n        tween(prefab)\r\n            .to(0.15, { scale: new Vec3(1, 1.2, 1) }, { easing: 'quadOut' })\r\n            .to(0.05, { scale: new Vec3(1.44, 1.44, 1.44) }, { easing: 'quadOut' })\r\n\r\n            .start();\r\n    }\r\n\r\n    public update(dt: number) {\r\n        for (let index = 0; index < this.beetleList.length; index++) {\r\n            const enemy = this.beetleList[index];\r\n            enemy?.getComponent(PlayerBeetle)?.update(dt);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}