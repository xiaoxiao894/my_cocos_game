{"version":3,"sources":["file:///D:/Cocos/PlayAble/SSD_0616_WP_ShouJiJieSuoDiKuai/assets/Script/core/touchEvent.ts"],"names":["_decorator","Camera","Component","geometry","Input","PhysicsSystem","Animation","Vec3","EnemyTree","eventMgr","EventType","BehaviourType","Global","BubbleFead","super_html_playable","ccclass","property","touchEvent","originalScale","upgradeNode","upgradeNode1","clickTreeUI","cornLandArrow","nameUUId","lastTouchTime","clickInterval","nameUIID","start","update","deltaTime","onEnable","node","on","TOUCH_START","onTouchStart","bind","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","onDisable","off","event","currentTime","Date","now","touchPos","getLocation","ray","Ray","mainCamera","screenPointToRay","x","y","mask","maxDistance","queryTrigger","console","log","instance","raycastClosest","result","raycastClosestResult","collider","nodeName","name","startsWith","uuid","indexOf","push","clickNum","parent","getChildByName","active","scale","clone","multiplyScalar","isClickUpLandTree","enemyTree","getComponent","isFind","getFindState","isClickEnemy","getFeadState","hideFead","emit","ENTITY_MOVE_TREE","Tree","treeHandOver","ENTITY_MOVE_HAND_OVER","HandOver","isUpgrade","isClickUpgradeEnemy","soundManager","playWarnSound","red","stop","play","SHOW_ENEMY","EnemyHnadOverPos","isClickUpgrade","upgradeUIAnimtion","ENTITY_ENEMY_HAND_OVER","isMoveCamreToCorn","ENTITY_TREE_TRANSMIT","isClickUpLandCorn","arrowNum","parseInt","replace","clickCornLand","ENTITY_CORN_CUT","ENTITY_ENEMY_TRANSMIT","ENTITY_CLICK_ENEMY","btnDown","download"],"mappings":"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","sourcesContent":["import { _decorator, Camera, Component, EventTouch, geometry, Input, PhysicsSystem, Animation, Vec3, Quat } from 'cc';\r\n\r\nimport { EnemyTree } from '../entitys/EnemyTree';\r\nimport { eventMgr } from './EventManager';\r\nimport { EventType } from './EventType';\r\nimport { BehaviourType } from '../entitys/Character';\r\nimport { Global } from './Global';\r\nimport { BubbleFead } from '../BubbleFead';\r\nimport super_html_playable from '../../super_html_playable';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('touchEvent')\r\nexport class touchEvent extends Component {\r\n\r\n    @property(Camera)\r\n    private mainCamera: Camera = null;\r\n    private originalScale: Vec3 = new Vec3(1, 1, 1); // 存储原始缩放值\r\n\r\n    private upgradeNode = null;\r\n    private upgradeNode1 = null;\r\n    private clickTreeUI = null;\r\n    private cornLandArrow = null;\r\n    start() {\r\n        //this.mainCamera = WorldMap.instance.mainCamera;\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n\r\n    protected onEnable(): void {\r\n        this.node.on(Input.EventType.TOUCH_START, this.onTouchStart.bind(this), this);;\r\n        this.node.on(Input.EventType.TOUCH_MOVE, this.onTouchMove.bind(this), this);\r\n        this.node.on(Input.EventType.TOUCH_END, this.onTouchEnd.bind(this), this);\r\n        this.node.on(Input.EventType.TOUCH_CANCEL, this.onTouchEnd.bind(this), this);\r\n\r\n\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        this.node.off(Input.EventType.TOUCH_START, this.onTouchStart, this);;\r\n        this.node.off(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        this.node.off(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.off(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n\r\n    }\r\n    private nameUUId = null;\r\n    // 记录上次点击的时间\r\n    private lastTouchTime: number = 0;\r\n    // 点击间隔时间，单位：毫秒\r\n    private clickInterval: number = 100;\r\n    private nameUIID: any[] = [];\r\n    onTouchStart(event: EventTouch) {\r\n        const currentTime = Date.now();\r\n        // 检查距离上次点击是否超过设定的间隔时间\r\n        if (currentTime - this.lastTouchTime < this.clickInterval) {\r\n            return;\r\n        }\r\n        // 更新上次点击时间\r\n        this.lastTouchTime = currentTime;\r\n        const touchPos = event.getLocation();\r\n        const ray = new geometry.Ray();\r\n        this.mainCamera.screenPointToRay(touchPos.x, touchPos.y, ray);\r\n\r\n        const mask = 1 << 1;\r\n        const maxDistance = 10000000;\r\n        const queryTrigger = true;\r\n\r\n        console.log(\"mask mask == \" + mask)\r\n        // 调用射线检测，返回是否检测到碰撞体\r\n        if (PhysicsSystem.instance.raycastClosest(ray, mask, maxDistance, queryTrigger)) {\r\n            const result = PhysicsSystem.instance.raycastClosestResult;\r\n            if (result.collider) {\r\n                this.clickTreeUI = null;\r\n                //this.clickTreeUI.scale = new Vec3(0.8, 0.8, 0.8);\r\n                let nodeName = result.collider.node.name;\r\n                if (nodeName.startsWith(\"UI_famuzhiyin\")) { //点击了树\r\n                    if (!this.nameUUId) {\r\n                        this.nameUUId = result.collider.node.uuid;\r\n                    } else {\r\n                        if (this.nameUUId != result.collider.node.uuid) {\r\n                            this.nameUUId = result.collider.node.uuid;\r\n                            // this.nameUIID\r\n                            if (this.nameUIID.indexOf(this.nameUUId) === -1) {\r\n                                this.nameUIID.push(this.nameUUId);\r\n                                Global.clickNum += 1;\r\n                            }\r\n                            // this.nameUIID.push(result.collider.node.uuid);\r\n\r\n\r\n                            // \r\n                        }\r\n                    }\r\n\r\n                    if (result.collider.node.parent.getChildByName(\"UI_ZYXS\")?.active) {\r\n                        result.collider.node.parent.getChildByName(\"UI_ZYXS\").active = false;\r\n                    }\r\n\r\n                    this.clickTreeUI = result.collider.node\r\n                    this.clickTreeUI.scale = this.clickTreeUI.scale.clone().multiplyScalar(0.8);\r\n                    if (!Global.isClickUpLandTree) {\r\n                        return;\r\n                    }\r\n                    let enemyTree = result.collider.node.parent.getComponent(EnemyTree)\r\n                    let isFind = enemyTree.getFindState();\r\n                    if (Global.isClickEnemy && result.collider.node.getComponent(BubbleFead).getFeadState() == false) {\r\n                        isFind = true;\r\n                    }\r\n                    if (isFind) {\r\n\r\n                        //渐变消失效果\r\n                        if (result.collider.node.getComponent(BubbleFead)) {\r\n                            result.collider.node.getComponent(BubbleFead).hideFead();\r\n                        }\r\n                        //已经被寻找\r\n                        //enemyTree.setFindState(false);\r\n                        eventMgr.emit(EventType.ENTITY_MOVE_TREE, enemyTree, BehaviourType.Tree);\r\n                    }\r\n\r\n                } else if (nodeName == \"upgradeNode\") { //点击的交付木材按钮\r\n                    if (result.collider.node.getChildByName(\"UI_ZYXS\")?.active) {\r\n                        result.collider.node.getChildByName(\"UI_ZYXS\").active = false;\r\n                    }\r\n                    this.upgradeNode = result.collider.node\r\n                    this.upgradeNode.scale = new Vec3(0.8, 0.8, 0.8);\r\n                    Global.treeHandOver = true;\r\n                    eventMgr.emit(EventType.ENTITY_MOVE_HAND_OVER, result.collider, BehaviourType.HandOver);\r\n\r\n                } else if (nodeName == \"upgradeNode-001\") {\r\n                    if (Global.isUpgrade) {\r\n                        if (!Global.isClickUpgradeEnemy) {\r\n                            Global.isClickUpgradeEnemy = true;\r\n                            Global.soundManager.playWarnSound();\r\n                            let red = result.collider.node.getChildByName(\"2dNode\").getChildByName(\"scaleNode\").getChildByName(\"Sprite-red\")\r\n                            red.active = true;\r\n                            result.collider.node.getComponent(Animation).stop();\r\n                            result.collider.node.getComponent(Animation).play(\"shanhong\");\r\n                            eventMgr.emit(EventType.SHOW_ENEMY, result.collider, BehaviourType.EnemyHnadOverPos);\r\n                            // if (Global.upgradeUIAnimtion != 3) {\r\n                            //     Global.upgradeUIAnimtion = 3;\r\n                            // }\r\n                        }\r\n\r\n                        if (!Global.isClickUpgrade) {\r\n                            Global.soundManager.playWarnSound();\r\n                            return;\r\n                        }\r\n                        if (result.collider.node.getChildByName(\"UI_ZYXS\")?.active) {\r\n                            result.collider.node.getChildByName(\"UI_ZYXS\").active = false;\r\n                        }\r\n                        if (Global.upgradeUIAnimtion != 3) {\r\n                            Global.upgradeUIAnimtion = 3;\r\n                        }\r\n                        this.upgradeNode1 = result.collider.node\r\n                        this.upgradeNode1.scale = new Vec3(0.8, 0.8, 0.8);\r\n                        eventMgr.emit(EventType.ENTITY_ENEMY_HAND_OVER, result.collider, BehaviourType.EnemyHnadOverPos);\r\n                    }\r\n\r\n                }\r\n                else if (nodeName == \"TreeArrow\") { //tree 点击传送下个地块\r\n\r\n                    if (result.collider.node.getChildByName(\"UI_ZYXS\")?.active) {\r\n                        result.collider.node.getChildByName(\"UI_ZYXS\").active = false;\r\n                    }\r\n                    Global.isMoveCamreToCorn = true;\r\n                    eventMgr.emit(EventType.ENTITY_TREE_TRANSMIT, result.collider.node);\r\n\r\n                } else if (nodeName.startsWith(\"Arrow\")) {\r\n                    if (!Global.isClickUpLandCorn || Global.isMoveCamreToCorn) {\r\n                        return;\r\n                    }\r\n                    if (result.collider.node.getChildByName(\"UI_ZYXS\")?.active) {\r\n                        result.collider.node.getChildByName(\"UI_ZYXS\").active = false;\r\n                    }\r\n                    const arrowNum = parseInt(nodeName.replace(\"Arrow\", \"\"))\r\n                    Global.clickCornLand[arrowNum] = 1;\r\n                    this.cornLandArrow = result.collider.node;\r\n                    this.cornLandArrow.scale = this.cornLandArrow.scale.clone().multiplyScalar(0.8);\r\n                    eventMgr.emit(EventType.ENTITY_CORN_CUT, result.collider.node);\r\n\r\n                } else if (nodeName.startsWith(\"TreeArrow-001\")) {\r\n\r\n                    if (result.collider.node.getChildByName(\"UI_ZYXS\")?.active) {\r\n                        result.collider.node.getChildByName(\"UI_ZYXS\").active = false;\r\n                    }\r\n\r\n                    eventMgr.emit(EventType.ENTITY_ENEMY_TRANSMIT, result.collider.node);\r\n\r\n                } else if (nodeName.startsWith(\"SangshiPrefab\")) {\r\n\r\n\r\n                    if (result.collider.node.parent.getChildByName(\"UI_gongji_3\").getChildByName(\"UI_ZYXS\")?.active) {\r\n                        result.collider.node.parent.getChildByName(\"UI_gongji_3\").getChildByName(\"UI_ZYXS\").active = false;\r\n                    }\r\n                    //  result.collider.enabled = false;\r\n                    //  result.collider.destroy()\r\n                    if (result.collider.node.getComponent(BubbleFead)) {\r\n                        if (result.collider.node.getComponent(BubbleFead).getFeadState()) {\r\n                            return\r\n                        } else {\r\n\r\n                            result.collider.node.getComponent(BubbleFead).hideFead();\r\n                            eventMgr.emit(EventType.ENTITY_CLICK_ENEMY, result.collider.node);\r\n                        }\r\n\r\n                    }\r\n\r\n                }\r\n                console.log(\"点击到了模型:\", result.collider.node.name);\r\n                // 在这里写点击模型后的逻辑\r\n            }\r\n        } else {\r\n            console.log(\"未检测到碰撞体\");\r\n        }\r\n    }\r\n    onTouchMove(event: EventTouch) {\r\n\r\n    }\r\n    onTouchEnd(event: EventTouch) {\r\n\r\n        if (this.upgradeNode) {\r\n            this.upgradeNode.scale = new Vec3(1, 1, 1);\r\n        }\r\n\r\n        if (this.upgradeNode1) {\r\n            this.upgradeNode1.scale = new Vec3(1, 1, 1);\r\n        }\r\n        if (this.clickTreeUI) {\r\n            //this.clickTreeUI.scale = new Vec3(1, 1, 1);\r\n            this.clickTreeUI.scale = this.clickTreeUI.scale.clone().multiplyScalar(1.2);\r\n        }\r\n        if (this.cornLandArrow) {\r\n            this.cornLandArrow.scale = new Vec3(1, 1, 1);\r\n            if (!Global.isClickUpLandCorn) {\r\n                return;\r\n            }\r\n            ///this.cornLandArrow.scale.clone().multiplyScalar(1.2);\r\n        }\r\n    }\r\n    btnDown() {\r\n        super_html_playable.download();\r\n    }\r\n}\r\n\r\n\r\n\r\n"]}