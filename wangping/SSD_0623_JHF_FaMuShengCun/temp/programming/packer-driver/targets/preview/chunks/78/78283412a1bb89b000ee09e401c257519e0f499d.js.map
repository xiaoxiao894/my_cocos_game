{"version":3,"sources":["file:///D:/Cocos/PlayAble/SSD_0623_JHF_FaMuShengCun/assets/JavaScript/pillars/PillarManager.ts"],"names":["_decorator","Component","PillarItem","DataManager","ccclass","property","PillarManager","_activeIndex","_deliveringNum","start","Instance","pillarManager","pillars","forEach","item","guideTargetList","push","node","scheduleOnce","pillarActive","deliverItem","length","itemAdd","isUnlocked","deliverNeedNum","getLeftNeedNum"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AACXC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,W,iBAAAA,W;;;;;;;;;OAIH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;yBAGTM,a,WADpBF,OAAO,CAAC,iBAAD,C,UAGHC,QAAQ;AAAA;AAAA,mC,2BAHb,MACqBC,aADrB,SAC2CL,SAD3C,CACqD;AAAA;AAAA;;AAAA;;AAAA,eAKzCM,YALyC,GAKnB,CALmB;AAAA,eAMzCC,cANyC,GAMjB,CANiB;AAAA;;AASvCC,QAAAA,KAAK,GAAS;AACpB;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,aAArB,GAAqC,IAArC;AACA,eAAKC,OAAL,CAAaC,OAAb,CAAsBC,IAAD,IAAQ;AACzB;AAAA;AAAA,4CAAYJ,QAAZ,CAAqBK,eAArB,CAAqCC,IAArC,CAA0CF,IAAI,CAACG,IAA/C;AACH,WAFD,EAFoB,CAKpB;;AACA,eAAKC,YAAL,CAAkB,MAAI;AAClB,iBAAKN,OAAL,CAAa,KAAKL,YAAlB,EAAgCY,YAAhC;AACH,WAFD,EAEE,CAFF;AAIH;;AAEMC,QAAAA,WAAW,GAAE;AAChB,cAAG,KAAKb,YAAL,IAAmB,KAAKK,OAAL,CAAaS,MAAnC,EAA0C;AACtC;AACH;;AACD,eAAKb,cAAL;AACA,eAAKU,YAAL,CAAkB,MAAI;AAClB,iBAAKN,OAAL,CAAa,KAAKL,YAAlB,EAAgCe,OAAhC;;AACA,gBAAG,KAAKV,OAAL,CAAa,KAAKL,YAAlB,EAAgCgB,UAAhC,EAAH,EAAgD;AAC5C,mBAAKhB,YAAL;;AACA,kBAAG,KAAKK,OAAL,CAAa,KAAKL,YAAlB,CAAH,EAAmC;AAC/B,qBAAKK,OAAL,CAAa,KAAKL,YAAlB,EAAgCY,YAAhC;AACH;AACJ;;AACD,iBAAKX,cAAL;AACH,WATD,EASE,GATF;AAUH;;AAEMgB,QAAAA,cAAc,GAAS;AAE1B,iBAAO,KAAKZ,OAAL,CAAa,KAAKL,YAAlB,EAAgCkB,cAAhC,KAAiD,KAAKjB,cAA7D;AACH;;AAzCgD,O;;;;;iBAG5B,E","sourcesContent":["import {_decorator, Component } from \"cc\";\r\nimport { PillarItem } from \"./PillarItem\";\r\nimport { DataManager } from \"../Global/DataManager\";\r\n\r\n\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PillarComponent')\r\nexport default class PillarManager extends Component {\r\n\r\n    @property(PillarItem)\r\n    pillars:PillarItem[]=[];\r\n\r\n    private _activeIndex:number = 0;\r\n    private _deliveringNum:number = 0;\r\n\r\n\r\n    protected start(): void {\r\n        DataManager.Instance.pillarManager = this;\r\n        this.pillars.forEach((item)=>{\r\n            DataManager.Instance.guideTargetList.push(item.node);\r\n        });\r\n        //直接激活第一个\r\n        this.scheduleOnce(()=>{\r\n            this.pillars[this._activeIndex].pillarActive();\r\n        },0);\r\n        \r\n    }\r\n\r\n    public deliverItem(){\r\n        if(this._activeIndex>=this.pillars.length){\r\n            return;\r\n        }\r\n        this._deliveringNum++;\r\n        this.scheduleOnce(()=>{\r\n            this.pillars[this._activeIndex].itemAdd();\r\n            if(this.pillars[this._activeIndex].isUnlocked()){\r\n                this._activeIndex++;\r\n                if(this.pillars[this._activeIndex]){\r\n                    this.pillars[this._activeIndex].pillarActive();\r\n                }\r\n            }\r\n            this._deliveringNum--;\r\n        },0.2);\r\n    }\r\n\r\n    public deliverNeedNum():number{\r\n\r\n        return this.pillars[this._activeIndex].getLeftNeedNum()+this._deliveringNum;\r\n    }\r\n\r\n}\r\n\r\n"]}