{"version":3,"sources":["file:///D:/Cocos/PlayAble/SSD_0623_JHF_FaMuShengCun/assets/JavaScript/ElectricTower/ElectricTowerManager.ts"],"names":["_decorator","Component","instantiate","Pool","DataManager","EntityTypeEnum","ccclass","property","ElectricTowerManager","_electricTowerPool","_electricTowerCount","start","Instance","electricTowerManager","electricTowerManagerInit","electricTowerPrefab","prefabMap","get","Electricity","node","removeFromParent","createElectricTower","alloc","parent","setParent","active","onDestroy","destroy","onElectricTowerDead","free"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAmBC,MAAAA,I,OAAAA,I;;AAC1CC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,c,iBAAAA,c;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;sCAGjBQ,oB,WADZF,OAAO,CAAC,sBAAD,C,gBAAR,MACaE,oBADb,SAC0CP,SAD1C,CACoD;AAAA;AAAA;AAAA,eACxCQ,kBADwC,GACA,IADA;AAAA,eAExCC,mBAFwC,GAEV,GAFU;AAAA;;AAIhDC,QAAAA,KAAK,GAAS;AACV;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,oBAArB,GAA4C,IAA5C;AACH;;AAEDC,QAAAA,wBAAwB,GAAG;AACvB,eAAKL,kBAAL,GAA0B,IAAIN,IAAJ,CAAS,MAAM;AACrC,gBAAMY,mBAAmB,GAAG;AAAA;AAAA,4CAAYH,QAAZ,CAAqBI,SAArB,CAA+BC,GAA/B,CAAmC;AAAA;AAAA,kDAAeC,WAAlD,CAA5B;AACA,mBAAOhB,WAAW,CAACa,mBAAD,CAAlB;AACH,WAHyB,EAGvB,KAAKL,mBAHkB,EAGIS,IAAD,IAAgB;AACzCA,YAAAA,IAAI,CAACC,gBAAL;AACH,WALyB,CAA1B;AAMH;;AAEDC,QAAAA,mBAAmB,GAAG;AAClB,cAAI,CAAC,KAAKZ,kBAAV,EAA8B;;AAE9B,cAAMU,IAAI,GAAG,KAAKV,kBAAL,CAAwBa,KAAxB,EAAb;;AACA,cAAIH,IAAI,CAACI,MAAL,IAAe,IAAnB,EAAyBJ,IAAI,CAACK,SAAL,CAAe,KAAKL,IAApB;AACzBA,UAAAA,IAAI,CAACM,MAAL,GAAc,IAAd;AAEA,iBAAON,IAAP;AACH;;AAEDO,QAAAA,SAAS,GAAG;AACR,eAAKjB,kBAAL,CAAwBkB,OAAxB;AACH;;AAEDC,QAAAA,mBAAmB,CAACT,IAAD,EAAO;AACtBA,UAAAA,IAAI,CAACM,MAAL,GAAc,KAAd;;AACA,eAAKhB,kBAAL,CAAwBoB,IAAxB,CAA6BV,IAA7B;AACH;;AAlC+C,O","sourcesContent":["import { _decorator, Component, instantiate, Node, Pool } from 'cc';\r\nimport { DataManager } from '../Global/DataManager';\r\nimport { EntityTypeEnum } from '../Enum/Index';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('ElectricTowerManager')\r\nexport class ElectricTowerManager extends Component {\r\n    private _electricTowerPool: Pool<Node> | null = null;\r\n    private _electricTowerCount: number = 300;\r\n\r\n    start(): void {\r\n        DataManager.Instance.electricTowerManager = this;\r\n    }\r\n\r\n    electricTowerManagerInit() {\r\n        this._electricTowerPool = new Pool(() => {\r\n            const electricTowerPrefab = DataManager.Instance.prefabMap.get(EntityTypeEnum.Electricity);\r\n            return instantiate(electricTowerPrefab)\r\n        }, this._electricTowerCount, (node: Node) => {\r\n            node.removeFromParent();\r\n        })\r\n    }\r\n\r\n    createElectricTower() {\r\n        if (!this._electricTowerPool) return;\r\n\r\n        const node = this._electricTowerPool.alloc();\r\n        if (node.parent == null) node.setParent(this.node);\r\n        node.active = true;\r\n\r\n        return node;\r\n    }\r\n\r\n    onDestroy() {\r\n        this._electricTowerPool.destroy();\r\n    }\r\n\r\n    onElectricTowerDead(node) {\r\n        node.active = false;\r\n        this._electricTowerPool.free(node);\r\n    }\r\n}\r\n\r\n\r\n"]}