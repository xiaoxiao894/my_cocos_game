{"version":3,"sources":["file:///D:/Cocos/PlayAble/SSD_0623_JHF_FaMuShengCun/assets/JavaScript/Common/Util.ts"],"names":["Util","v2","v3","simpleV2","value","out","set","simpleV3","v2t3","v2Data","x","y","z","v3t2","v3Data","randomNumber","min","max","Math","floor","random","findArrNullIdx","arr","length","i","splitNumber","str","Separator","split","map","s_num","idx","Number","weightRandomIdx","weights","tw","rw","sw","ew","numMoveZoro","num","indexOf","replace","secondFormat","h","f","getDateStr","time","format","date","Date","getFullYear","m","getMonth","d","getDate","getHours","mn","getMinutes","mnStr","generatorCallBack","len","callBack","params","gen","exeGenerator","generator","duration","Promise","resolve","reject","execute","startTime","getTime","iter","next","done","setTimeout","copyObj","src_obj","dst_obj","key","cloneObj","obj","new_obj","constructor","Object","Array"],"mappings":"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","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { v2, v3, Vec2, Vec3 } from \"cc\";\r\n\r\n\r\nexport default class Util {\r\n\r\n\r\n    static simpleV2(value, out?: Vec2) {\r\n        if (out) {\r\n            out.set(value, value)\r\n            return out\r\n        }\r\n        return v2(value, value)\r\n    }\r\n\r\n    static simpleV3(value, out?: Vec3) {\r\n        if (out) {\r\n            out.set(value, value, value)\r\n            return out\r\n        }\r\n        return v3(value, value, value)\r\n    }\r\n\r\n    static v2t3(v2Data: Vec2, out?: Vec3) {\r\n        if (!out) {\r\n            return v3(v2Data.x, v2Data.y, 1)\r\n        } else {\r\n            out.x = v2Data.x\r\n            out.y = 0\r\n            out.z = v2Data.y\r\n            return out\r\n        }\r\n    }\r\n\r\n    static v3t2(v3Data: Vec3, out?: Vec2) {\r\n        if (!out) {\r\n            return v2(v3Data.x, v3Data.z)\r\n        } else {\r\n            out.x = v3Data.x\r\n            out.y = v3Data.z\r\n            return out\r\n        }\r\n    }\r\n\r\n    /**\r\n     * return min  - max  之间的数，包括min和max\r\n     * @param min \r\n     * @param max \r\n     */\r\n    static randomNumber(min: number, max: number) {\r\n        if (min == max) {\r\n            return min\r\n        }\r\n        return Math.floor(Math.random() * (max - min + 1) + min)\r\n    }\r\n\r\n    static findArrNullIdx(arr: any[]) {\r\n        if (arr.length == 0) return 0;\r\n        for (let i = 0; i < arr.length; i++) {\r\n            if (!arr[i]) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    //分割number字符串 返回number 数组\r\n    public static splitNumber(str: number | string, Separator: string = ',') {\r\n        if (!str) return [];\r\n        if (typeof str == 'number') {\r\n            return [str];\r\n        }\r\n\r\n        return str.split(Separator).map((s_num, idx) => {\r\n            return Number(s_num);\r\n        })\r\n    }\r\n\r\n    /**\r\n     * @param weights 权重数组 随机一个\r\n     * @returns \r\n     */\r\n    static weightRandomIdx(weights: number[]) {\r\n        if (weights.length <= 1) {\r\n            return 0;\r\n        }\r\n\r\n        let tw: number = 0;\r\n        for (let i = 0; i < weights.length; i++) {\r\n            tw += weights[i];\r\n        }\r\n        let rw = Math.random() * tw;\r\n        let sw: number = 0, ew: number = 0;\r\n\r\n        for (let i = 0; i < weights.length; i++) {\r\n            ew = sw + weights[i];\r\n            if (sw < rw && rw <= ew) {\r\n                return i;\r\n            }\r\n            sw = ew;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    /**小数去0 */\r\n    public static numMoveZoro(num: string) {\r\n        if (num.indexOf('.') < 0) {\r\n            return num;\r\n        }\r\n        num = num.replace(/0+?$/g, '')\r\n        if (num[num.length - 1] == '.') {\r\n            num = num.replace(/[.$]/, '');\r\n        }\r\n        return num;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param num 秒 格式化  h:f:s\r\n     */\r\n    public static secondFormat(num: number) {\r\n        let str = '';\r\n        let h: number = Math.floor(num / 3600)\r\n        num -= h * 3600;\r\n        let f: number = Math.floor(num / 60)\r\n        num -= f * 60;\r\n        num = Math.floor(num)\r\n\r\n        // str += (h<10?'0' + h:h);\r\n\r\n        // str += ':';\r\n        str += (f < 10 ? '0' + f : f);\r\n\r\n        str += ':';\r\n        str += (num < 10 ? '0' + num : num);\r\n\r\n        return str;\r\n    }\r\n\r\n    /**日期展示 */\r\n    public static getDateStr(time: number, format: number = 1) {\r\n\r\n        let date = new Date(time);\r\n        let y = date.getFullYear(), m = date.getMonth() + 1,\r\n            d = date.getDate(), h = date.getHours(), mn = date.getMinutes();\r\n\r\n        let mnStr = '' + mn;\r\n        if (mn < 10) mnStr = '0' + mn;\r\n        if (format == 1) {\r\n            return `${y}/${m}/${d}  ${h}:${mnStr}`;\r\n        } else {\r\n            return `${y}年${m}月${d}日  ${h}:${mnStr}`;\r\n        }\r\n\r\n    }\r\n\r\n\r\n    static generatorCallBack(len: number, callBack: Function, ...params: any) {\r\n        function* gen() {\r\n            for (let i = 0; i < len; i++) {\r\n                yield callBack(i, ...params)\r\n            }\r\n        }\r\n        return this.exeGenerator(gen(), 10);\r\n    }\r\n\r\n    static exeGenerator(generator: Generator, duration: number) {\r\n        return new Promise((resolve, reject) => {\r\n            let gen = generator\r\n            let execute = () => {\r\n                let startTime = new Date().getTime()\r\n                for (let iter = gen.next(); ; iter = gen.next()) {\r\n                    if (iter == null || iter.done) {\r\n                        resolve(null)\r\n                        return\r\n                    }\r\n                    if (new Date().getTime() - startTime > duration) {\r\n                        setTimeout(() => {\r\n                            execute()\r\n                        }, duration)\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n            execute()\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 拷贝对象\r\n     * @param src_obj 源对象\r\n     * @param dst_obj 目标对象\r\n     */\r\n    static copyObj(src_obj: any, dst_obj: any) {\r\n        if (typeof dst_obj === \"object\") {\r\n            for (var key in dst_obj) {\r\n                if (typeof dst_obj[key] === \"object\") {\r\n                    src_obj[key] != null && Util.copyObj(src_obj[key], dst_obj[key]);\r\n                } else if (typeof dst_obj[key] != \"function\") {\r\n                    src_obj[key] != null && (dst_obj[key] = src_obj[key]);\r\n                }\r\n            }\r\n        } else {\r\n            // console.log(\"can not copy the value type\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 克隆对象\r\n     * @param obj 源对象\r\n     * @returns 新的对象\r\n     */\r\n    static cloneObj(obj: any) {\r\n        var new_obj;\r\n        if (obj != null && (obj.constructor === Object || obj.constructor === Array)) {\r\n            new_obj = new obj.constructor();\r\n            for (var key in obj) {\r\n                new_obj[key] = Util.cloneObj(obj[key]);\r\n            }\r\n        } else {\r\n            new_obj = obj;\r\n        }\r\n        return new_obj;\r\n    }\r\n}"]}