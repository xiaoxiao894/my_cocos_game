{"version":3,"sources":["file:///D:/Cocos/PlayAble/L_DefendTheCup/assets/JavaScript/Actor/Actor.ts"],"names":["_decorator","Animation","AnimationClip","BoxCollider","CCFloat","Collider","Color","Component","director","find","gfx","instantiate","Label","Mat4","Material","math","MeshRenderer","Node","RigidBody","SkeletalAnimation","Texture2D","tween","UIOpacity","v3","Vec3","Vec4","MinionStateEnum","StateDefine","MathUtil","DataManager","FlowField","AreaEnum","CollisionEntityEnum","EntityTypeEnum","PathEnum","ItemAreaManager","RVOObstacles","Simulator","MinionManager","ccclass","property","tempVelocity","Actor","type","tooltip","destForward","collider","rigidbody","currentState","Idle","uiproperty","onceData","isWeaponArea","_weaponCollectIndex","_weaponCollecting","_weaponCollectDelay","_hasWeaponDeliverdOnce","isUnlockDeliveryAreas6","isDeliverCoins","otherNode","_isWeaponDelivering","_weaponQueue","_weaponDeliverInterval","deliveryCountMap","Map","pendingDeliveryCountMap","_deliverInterval","_deliverTimer","start","node","getComponent","getChildByName","on","onTriggerEnter","onTriggerStay","onTriggerExit","showPlane","meshRenderer","material","initialize","effectName","technique","defines","USE_TEXTURE","targetColor","R","G","B","startColorVec4","r","g","b","setProperty","texture","tilingOffset","setMaterial","tweenColor","x","y","z","to","w","onUpdate","colorToVec4","color","a","update","deltaTime","deliverCoinsFun","canCollect","getPlayerWeaponStep","Die","signAngle","forward","UP","as","setAngularVelocity","doMove","speed","linearSpeed","length","clamp","setLinearVelocity","Instance","updateFlowField","getWorldPosition","clone","startWeaponCollecting","deliveryAreas7","DeliveryAreas7","buildingCon","weapons","isZeroScale","scale","children","arrangeDeliveredWeapons","minionWeaponCon","MinionWeaponCon","itemsPerRow","horizontalSpacing","verticalSpacing","validWeapons","filter","__delivered","__used","forEach","weapon","index","col","row","Math","floor","targetPos","setPosition","weaponDelivery","backpack2","player","reverse","isInWeaponDeliveryArea","item","shift","isValid","scheduleOnce","nextIndex","worldStartPos","worldTargetPos","add","midPoint","lerp","add3f","obj","t","easing","pos","bezierCurve","setWorldPosition","call","setParent","deliverAllWeaponsOnce","nextData","guideTargetList","name","isFind","isDisplay","deliveryAreas9","DeliveryAreas9","deliveryAreas9Plot","itemAreaManager9","displayAni","areas9Data","deliveryAreas10","DeliveryAreas10","deliveryAreas10Plot","itemAreaManage10","areas10Data","stopMove","ZERO","changState","state","clipName","aniState","skeletalAnimation","getState","Attack","crossFade","isPlaying","play","Walk","Walk_attack","wrapMode","WrapMode","Loop","console","warn","event","selfCollider","otherCollider","includes","scene","side","split","sceneMap","Scene1","L","scene1LSide","T","scene1TSide","scene1BSide","scene1RSide","Scene2","scene2LSide","scene2TSide","scene2BSide","scene2RSide","doorGroup","doorL","doorR","openDoorBySide","deliveryAreaNames","key","hasOwnProperty","push","indexOf","duration","angleMap","left","right","config","eulerAngles","isConveyorBeltUnlocking","DeliverEquipmentArea","backpack1","plot","deliveryNumNode","label","isNotZeroScale","total","get","undefined","Number","string","set","pending","success","deliverItemToTarget","targetNode","currentTotal","currentPending","iconSprite","stop","deliveryNumSprite","itemWorldPos","worldPosition","parent","end","control","max","controller","oneMinusT","monsterManager","recycleDrop","soundManager","playIconSound","remaining","toString","UIPropertyManager","deliverProperty","_hasDeliveredZero","onDeliveryComplete","closeDoorBySide","isMinion","isAllMinionsPassed","uiOpacity","addComponent","opacity","BuildingUnlockSoundPlay","data","setScale","deliveryAreasPh","DeliveryAreasPh","deliveryAreas","boxCollider","enabled","wakeUp","unlockNewSpecies","DeliveryAreas3","DeliveryAreas4","DeliveryAreas5","deliveryAreas6","DeliveryAreas6","itemAreaManager7","DeliveryAreas8","cardConManager","createCards","fencesScene1","FencesScene1","active","scene1PhysicsRight","Scene1PhysicsRight","i","rigidBody","sideList","doorLeft","childrenL","meshRendererL","shadowCastingMode","doorRight","childrenR","meshRendererR","meshRender","_hasFadedIn","originPos","getPosition","position","plane2","palne02Ani","deliveryAreas8","itemAreaManager8","displaySceneTwoPath","displaySceneRigidBody","Scene2Physics","addSceneToObstacle","sceneManager","addSceneDoorFun","monsters","getSurroundedMonsters","j","killMonsters","fencesScene2","FencesScene2","collectGuardrails","isGenerateWeapons","Scene2PhysicsRight","fencesScene3","FencesScene3","tSide","rSide","bSide","newList","plane3","palne03Ani","Scene3Physics","Scene3","isGameEnd","gameEndManager","init","conveyerBeltManager","DeliveryAreas1","DeliveryAreas2","minion","minionManager","worldPos","effectPrafab","prefabMap","TX_shengjiLZ","skillExplosion","getScene","addChild","anim","once","EventType","FINISHED","destroy","isLookingForMonsters","isMoveMinion","fadeInMesh3D","sharedMat","newMat","effectAsset","pass","passes","blendTarget","blendState","targets","blend","blendSrc","BlendFactor","SRC_ALPHA","blendDst","ONE_MINUS_SRC_ALPHA","baseColor","baseVec4","fade","alpha","fadeInMaterial","renderer","getMaterial","target","blendEq","tempColor","displayScene3RigidBody","scene3Physics","dirNode","activeInHierarchy","boxColider","path","scenePhysics","outNode","inNode","addOneObstacle","instance","processObstacles","list","roadS2H","RoadS2H","roadS2S","RoadS2S","playerWeaponRotationAni","maxY","child","localPos","localTarget","worldRot","getWorldRotation","worldScale","getWorldScale","worldMat","fromRTS","worldTarget","transformMat4","finalWorldPos","WeaponPickingUpSoundPlay","startEuler","targetEuler","rotCtrl","currentEuler","setRotationFromEuler"],"mappings":"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","sourcesContent":["import { _decorator, Animation, AnimationClip, AnimationState, BoxCollider, builtinResMgr, CCFloat, Collider, Color, Component, director, EffectAsset, find, gfx, ICollisionEvent, instantiate, Label, Mat4, Material, math, MeshRenderer, Node, resources, RigidBody, SkeletalAnimation, Slider, Texture2D, tween, UIOpacity, v3, Vec3, Vec4 } from 'cc';\r\nimport { MinionStateEnum, StateDefine } from './StateDefine';\r\nimport { MathUtil } from '../Util/MathUtil';\r\nimport { DataManager } from '../Global/DataManager';\r\nimport { FlowField } from '../Monster/FlowField';\r\nimport { AreaEnum, CollisionEntityEnum, EntityTypeEnum, GamePlayNameEnum, PathEnum } from '../Enum/Index';\r\nimport { UIPropertyManager } from '../UI/UIPropertyManager';\r\nimport { ItemAreaManager } from '../Area/ItemAreaManager';\r\nimport { GunTurretManager } from './GunTurretManager';\r\nimport RVOObstacles from '../Global/RVOObstacles';\r\nimport { Simulator } from '../RVO/Simulator';\r\nimport { MinionManager } from './MinionManager';\r\nimport { TweenMaterial } from '../Area/TweenMaterial';\r\nconst { ccclass, property } = _decorator;\r\n\r\nlet tempVelocity: Vec3 = v3();\r\n\r\n@ccclass('Actor')\r\nexport class Actor extends Component {\r\n    @property(SkeletalAnimation)\r\n    skeletalAnimation: SkeletalAnimation | null = null;\r\n\r\n    @property(CCFloat)\r\n    linearSpeed: number = 1.0;\r\n\r\n    @property(CCFloat)\r\n    angularSpeed: number = 90;\r\n\r\n    @property(Node)\r\n    scene1TSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene1RSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene1BSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene1LSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene2TSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene2RSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene2BSide: Node = null;\r\n\r\n    @property(Node)\r\n    scene2LSide: Node = null;\r\n\r\n    @property(Texture2D)\r\n    texture: Texture2D = null;\r\n\r\n    @property({ type: CCFloat, tooltip: \"R\" })\r\n    R = 163;\r\n\r\n    @property({ type: CCFloat, tooltip: \"G\" })\r\n    G = 150;\r\n\r\n    @property({ type: CCFloat, tooltip: \"B\" })\r\n    B = 0;\r\n\r\n    // const targetColor = new Color(163, 150, 0, 255);\r\n\r\n\r\n    destForward: Vec3 = v3();\r\n\r\n    collider: Collider | null = null;\r\n    rigidbody: RigidBody | null = null;\r\n\r\n    currentState: StateDefine | string = StateDefine.Idle;\r\n\r\n    uiproperty = null;\r\n\r\n    onceData = true;\r\n\r\n    // \r\n    isWeaponArea = false;\r\n\r\n    private _weaponCollectIndex = -1;\r\n    private _weaponCollecting = false;\r\n    private _weaponCollectDelay = 0;\r\n\r\n    //               FALSE TURE\r\n    private _hasWeaponDeliverdOnce = false;\r\n\r\n    // 6\r\n    private isUnlockDeliveryAreas6 = true;\r\n\r\n    // \r\n    private isDeliverCoins = false;\r\n    private otherNode = null;\r\n\r\n    start() {\r\n        this.rigidbody = this.node.getComponent(RigidBody);\r\n        this.collider = this.node.getComponent(Collider);\r\n\r\n        this.uiproperty = this.node.getChildByName(\"UIproperty\");\r\n\r\n        this.collider?.on(\"onTriggerEnter\", this.onTriggerEnter, this);\r\n        this.collider?.on(\"onTriggerStay\", this.onTriggerStay, this);\r\n        this.collider?.on(\"onTriggerExit\", this.onTriggerExit, this);\r\n    }\r\n\r\n    showPlane(node) {\r\n        const meshRenderer = node.getComponent(MeshRenderer);\r\n        const material = new Material();\r\n        material.initialize({\r\n            effectName: 'builtin-unlit',\r\n            technique: 1, // transparent\r\n            defines: {\r\n                USE_TEXTURE: true\r\n            }\r\n        });\r\n\r\n        // \r\n        const targetColor = new Color(this.R, this.G, this.B, 255);\r\n        const startColorVec4 = new Vec4(\r\n            targetColor.r / 255,\r\n            targetColor.g / 255,\r\n            targetColor.b / 255,\r\n            0   //  alpha = 0\r\n        );\r\n\r\n        // \r\n        material.setProperty('mainColor', startColorVec4);\r\n        material.setProperty('mainTexture', this.texture);\r\n        const tilingOffset = new Vec4(6, 8, 0, 0);\r\n        material.setProperty('tilingOffset', tilingOffset);\r\n        meshRenderer.setMaterial(material, 0);\r\n\r\n        //  alpha = 0  1\r\n        const tweenColor = new Vec4(startColorVec4.x, startColorVec4.y, startColorVec4.z, 0);\r\n        tween(tweenColor)\r\n            .to(1.5, {\r\n                w: 1 // Vec4 4 alpha\r\n            }, {\r\n                onUpdate: () => {\r\n                    material.setProperty('mainColor', tweenColor);\r\n                }\r\n            })\r\n            .start();\r\n\r\n    }\r\n\r\n    colorToVec4(color: Color): Vec4 {\r\n        return new Vec4(\r\n            color.r / 255,\r\n            color.g / 255,\r\n            color.b / 255,\r\n            color.a / 255\r\n        );\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        // \r\n        if (this.isDeliverCoins) {\r\n            this.deliverCoinsFun(deltaTime);\r\n        }\r\n\r\n        const canCollect = this._weaponCollecting && this.isWeaponArea;\r\n\r\n        if (canCollect) {\r\n            this._weaponCollectDelay += deltaTime;\r\n            if (this._weaponCollectDelay >= 0.2) {\r\n                this._weaponCollectDelay = 0;\r\n                this.getPlayerWeaponStep(); // \r\n            }\r\n        }\r\n\r\n        if (this.currentState == StateDefine.Die) {\r\n            return;\r\n        }\r\n\r\n        // \r\n        let a = MathUtil.signAngle(this.node.forward, this.destForward, Vec3.UP);\r\n        let as = v3(0, a * 20, 0);\r\n        this.rigidbody.setAngularVelocity(as);\r\n\r\n        //  \r\n        this.doMove();\r\n    }\r\n\r\n    doMove() {\r\n        let speed = this.linearSpeed * this.destForward.length() * 15;\r\n        tempVelocity.x = math.clamp(this.node.forward.x, -1, 1) * speed;\r\n        tempVelocity.z = math.clamp(this.node.forward.z, -1, 1) * speed;\r\n        this.rigidbody?.setLinearVelocity(tempVelocity);\r\n        FlowField.Instance.updateFlowField(this.node.getWorldPosition().clone());\r\n    }\r\n\r\n    // \r\n    startWeaponCollecting() {\r\n        const deliveryAreas7 = find(PathEnum.DeliveryAreas7);\r\n        if (!deliveryAreas7) return;\r\n\r\n        const buildingCon = deliveryAreas7.getChildByName(\"BuildingCon\");\r\n        const weapons = buildingCon?.getChildByName(\"Weapons\");\r\n        const isZeroScale = buildingCon && buildingCon.scale.x !== 0 && buildingCon.scale.y !== 0 && buildingCon.scale.z !== 0;\r\n        if (!isZeroScale || !weapons || weapons.children.length === 0) return;\r\n\r\n        this._weaponCollectIndex = weapons.children.length - 1;\r\n        this._weaponCollecting = true;\r\n    }\r\n\r\n    // \r\n    private _isWeaponDelivering: boolean = false;\r\n    private _weaponQueue: Node[] = [];\r\n    private _weaponDeliverInterval: number = 0.3;\r\n\r\n    private arrangeDeliveredWeapons() {\r\n        const minionWeaponCon = find(PathEnum.MinionWeaponCon);\r\n        if (!minionWeaponCon) return;\r\n\r\n        const itemsPerRow = 4;\r\n        const horizontalSpacing = 1.3;\r\n        const verticalSpacing = 1;\r\n\r\n        const validWeapons = minionWeaponCon.children.filter(w => (w as any).__delivered && !(w as any).__used);\r\n\r\n        validWeapons.forEach((weapon, index) => {\r\n            const col = index % itemsPerRow;\r\n            const row = Math.floor(index / itemsPerRow);\r\n            const targetPos = new Vec3(0, row * verticalSpacing, col * horizontalSpacing);\r\n            weapon.setPosition(targetPos);\r\n        });\r\n    }\r\n\r\n    weaponDelivery() {\r\n        if (this._isWeaponDelivering) return;\r\n\r\n        const backpack2 = DataManager.Instance.player.node.getChildByName(\"Backpack2\");\r\n        if (!backpack2 || backpack2.children.length === 0) return;\r\n\r\n        const minionWeaponCon = find(PathEnum.MinionWeaponCon);\r\n        if (!minionWeaponCon) return;\r\n\r\n        if (this._weaponQueue.length === 0) {\r\n            this._weaponQueue = [...backpack2.children].reverse();\r\n        }\r\n\r\n        if (this._weaponQueue.length === 0) return;\r\n\r\n        if (!DataManager.Instance.isInWeaponDeliveryArea) {\r\n            this._weaponQueue = [];\r\n            return;\r\n        }\r\n\r\n        const item = this._weaponQueue.shift();\r\n        if (!item?.isValid) {\r\n            this.scheduleOnce(() => this.weaponDelivery(), this._weaponDeliverInterval);\r\n            return;\r\n        }\r\n\r\n        this._isWeaponDelivering = true;\r\n\r\n        const itemsPerRow = 4;\r\n        const horizontalSpacing = 1.3;\r\n        const verticalSpacing = 1;\r\n\r\n        const validWeapons = minionWeaponCon.children.filter(w => (w as any).__delivered && !(w as any).__used);\r\n        const nextIndex = validWeapons.length;\r\n\r\n        const col = nextIndex % itemsPerRow;\r\n        const row = Math.floor(nextIndex / itemsPerRow);\r\n        const targetPos = new Vec3(0, row * verticalSpacing, col * horizontalSpacing);\r\n\r\n        const worldStartPos = item.getWorldPosition();\r\n        const worldTargetPos = minionWeaponCon.getWorldPosition().clone().add(targetPos);\r\n        const midPoint = worldStartPos.clone().lerp(worldTargetPos, 0.5).add3f(0, 5, 0);\r\n\r\n        const obj = { t: 0 };\r\n        tween(obj)\r\n            .to(0.6, { t: 1 }, {\r\n                easing: 'quadInOut',\r\n                onUpdate: () => {\r\n                    if (!item?.isValid) return;\r\n                    const pos = MathUtil.bezierCurve(worldStartPos, midPoint, worldTargetPos, obj.t);\r\n                    item.setWorldPosition(pos);\r\n                }\r\n            })\r\n            .call(() => {\r\n                item.setParent(minionWeaponCon);\r\n                (item as any).__delivered = true;\r\n                item.setPosition(targetPos);\r\n\r\n                this.arrangeDeliveredWeapons(); // \r\n\r\n                if (!this._hasWeaponDeliverdOnce) {\r\n                    this._hasWeaponDeliverdOnce = true;\r\n                    this.deliverAllWeaponsOnce();\r\n                }\r\n\r\n                this._isWeaponDelivering = false;\r\n\r\n                if (this._weaponQueue.length > 0 && DataManager.Instance.isInWeaponDeliveryArea) {\r\n                    this.scheduleOnce(() => this.weaponDelivery(), this._weaponDeliverInterval);\r\n                } else {\r\n                    this._weaponQueue = [];\r\n                }\r\n\r\n                const nextData = DataManager.Instance.guideTargetList.find(item => item.name === \"DeliverEquipmentArea\");\r\n                if (nextData) {\r\n                    nextData.isFind = false;\r\n                    nextData.isDisplay = false;\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n\r\n    // \r\n    deliverAllWeaponsOnce() {\r\n        const deliveryAreas9 = find(PathEnum.DeliveryAreas9);\r\n        const deliveryAreas9Plot = deliveryAreas9.getChildByName(\"Plot\");\r\n        const itemAreaManager9 = deliveryAreas9Plot.getComponent(ItemAreaManager);\r\n        itemAreaManager9?.displayAni(deliveryAreas9Plot);\r\n\r\n        const areas9Data = DataManager.Instance.guideTargetList.find(item => {\r\n            return item.name == \"DeliveryAreas9\";\r\n        })\r\n\r\n        if (areas9Data) {\r\n            areas9Data.isFind = true;\r\n            areas9Data.isDisplay = true;\r\n        }\r\n\r\n        const deliveryAreas10 = find(PathEnum.DeliveryAreas10);\r\n        const deliveryAreas10Plot = deliveryAreas10.getChildByName(\"Plot\");\r\n        const itemAreaManage10 = deliveryAreas10Plot.getComponent(ItemAreaManager);\r\n        itemAreaManage10?.displayAni(deliveryAreas10Plot);\r\n\r\n        const areas10Data = DataManager.Instance.guideTargetList.find(item => {\r\n            return item.name == \"DeliveryAreas10\";\r\n        })\r\n\r\n        if (areas10Data) {\r\n            areas10Data.isFind = true;\r\n            areas10Data.isDisplay = true;\r\n        }\r\n    }\r\n\r\n    stopMove() {\r\n        this.rigidbody?.setLinearVelocity(Vec3.ZERO);\r\n    }\r\n\r\n    changState(state: StateDefine | string) {\r\n        const clipName = state as string;\r\n\r\n        // \r\n        const aniState = this.skeletalAnimation?.getState(clipName);\r\n\r\n        // \r\n        if (state === StateDefine.Attack) {\r\n            this.skeletalAnimation?.crossFade(clipName, 0.1);\r\n            this.currentState = state;\r\n            return;\r\n        }\r\n\r\n        //  Walk/WALK_ATTACK \r\n        if (state === this.currentState) {\r\n            if (aniState && !aniState.isPlaying) {\r\n                this.skeletalAnimation?.play(clipName);\r\n            }\r\n            return;\r\n        }\r\n\r\n        //  Walk \r\n        if (\r\n            this.currentState === StateDefine.Walk ||\r\n            this.currentState === StateDefine.Walk_attack\r\n        ) {\r\n            this.stopMove();\r\n        }\r\n\r\n        if (aniState) {\r\n            aniState.wrapMode = AnimationClip.WrapMode.Loop; // \r\n            this.skeletalAnimation?.crossFade(clipName, 0.1);\r\n        } else {\r\n            console.warn(`${clipName}`);\r\n        }\r\n\r\n        this.currentState = state;\r\n    }\r\n\r\n\r\n    // \r\n    onTriggerEnter(event: ICollisionEvent) {\r\n        const selfCollider = event.selfCollider;\r\n        const otherCollider = event.otherCollider;\r\n\r\n        // \r\n        if (otherCollider.node.name.includes(\"Door\")) {\r\n            const [scene, side] = otherCollider.node.name.split(\"_\");\r\n\r\n            const sceneMap = {\r\n                Scene1: {\r\n                    L: this.scene1LSide,\r\n                    T: this.scene1TSide,\r\n                    B: this.scene1BSide,\r\n                    R: this.scene1RSide\r\n                },\r\n                Scene2: {\r\n                    L: this.scene2LSide,\r\n                    T: this.scene2TSide,\r\n                    B: this.scene2BSide,\r\n                    R: this.scene2RSide\r\n                }\r\n            };\r\n\r\n            const doorGroup = sceneMap[scene]?.[side]?.getChildByName(`${side}_Door`);\r\n            if (!doorGroup) {\r\n                console.warn(`[Door] ${scene}_${side} `);\r\n                return;\r\n            }\r\n\r\n            const doorL = doorGroup.getChildByName(\"Door_Left\");\r\n            const doorR = doorGroup.getChildByName(\"Door_Right\");\r\n\r\n            this.openDoorBySide(doorL, doorR, side);\r\n        }\r\n\r\n        // \r\n        var otherNode = otherCollider.node;\r\n\r\n        var deliveryAreaNames = [];\r\n        for (var key in CollisionEntityEnum) {\r\n            if (CollisionEntityEnum.hasOwnProperty(key)) {\r\n                deliveryAreaNames.push(CollisionEntityEnum[key]);\r\n            }\r\n        }\r\n\r\n        if (deliveryAreaNames.indexOf(otherNode.name) !== -1) {\r\n            this.isDeliverCoins = true;\r\n            this.otherNode = otherNode;\r\n        }\r\n    }\r\n    openDoorBySide(doorL: Node | null, doorR: Node | null, side: string) {\r\n        const duration = 0.3;\r\n\r\n        // /\r\n        const angleMap = {\r\n            L: { left: 70, right: 300 },\r\n            R: { left: -110, right: 110 },\r\n            T: { left: -20, right: 200 },\r\n            B: { left: 20, right: -200 }\r\n        };\r\n\r\n        const config = angleMap[side];\r\n        if (!config) {\r\n            console.warn(`[Door] : ${side}`);\r\n            return;\r\n        }\r\n\r\n        if (doorL?.isValid) {\r\n            tween(doorL)\r\n                .to(duration, { eulerAngles: new Vec3(0, config.left, 0) }, { easing: 'quadOut' })\r\n                .start();\r\n        }\r\n\r\n        if (doorR?.isValid) {\r\n            tween(doorR)\r\n                .to(duration, { eulerAngles: new Vec3(0, config.right, 0) }, { easing: 'quadOut' })\r\n                .start();\r\n        }\r\n    }\r\n\r\n    onTriggerStay(event: ICollisionEvent) {\r\n        const otherNode = event.otherCollider.node;\r\n        DataManager.Instance.isInWeaponDeliveryArea = true;\r\n\r\n        //  7\r\n        if (otherNode.name === \"ObtainEquipmentArea\" && !DataManager.Instance.isConveyorBeltUnlocking) {\r\n            this.isWeaponArea = true;\r\n            this.startWeaponCollecting();\r\n        }\r\n\r\n        // \r\n        if (otherNode.name === AreaEnum.DeliverEquipmentArea) {\r\n            this.weaponDelivery();\r\n        }\r\n        // // === \r\n        // const t0 = performance.now();\r\n        // const backpack1 = this.node.getChildByName(\"Backpack1\");\r\n        // if (!backpack1 || backpack1.children.length === 0) return;\r\n\r\n        // const deliveryAreaNames = Object.values(CollisionEntityEnum) as string[];\r\n        // if (!deliveryAreaNames.includes(otherNode.name)) return;\r\n\r\n        // const plot = otherNode.getChildByName(\"Plot\");\r\n        // const deliveryNumNode = plot?.getChildByName(\"DeliveryNum\");\r\n        // const label = deliveryNumNode?.getComponent(Label);\r\n        // const isNotZeroScale = plot?.scale.x !== 0 || plot.scale.y !== 0 || plot.scale.z !== 0;\r\n\r\n        // if (!plot || !deliveryNumNode || !label || !isNotZeroScale) return;\r\n\r\n        // let total = this.deliveryCountMap.get(otherNode);\r\n        // if (total === undefined) {\r\n        //     total = Number(label.string);\r\n        //     this.deliveryCountMap.set(otherNode, total);\r\n        // }\r\n\r\n        // const pending = this.pendingDeliveryCountMap.get(otherNode) ?? 0;\r\n        // if ((total - pending) > 0 && !this._deliverQueue.includes(otherNode)) {\r\n        //     this.pendingDeliveryCountMap.set(otherNode, pending + 1);\r\n        //     this._deliverQueue.push(otherNode);\r\n        //     this._tryDeliverNext();\r\n\r\n        //     const t1 = performance.now();\r\n        //     console.log(` deliverItemToTarget : ${(t1 - t0).toFixed(2)}ms`);\r\n        // }\r\n    }\r\n\r\n    // ===  Node  key ===\r\n    private deliveryCountMap: Map<Node, number> = new Map();\r\n    private pendingDeliveryCountMap: Map<Node, number> = new Map();\r\n    private _deliverInterval: number = 0.05;\r\n    private _deliverTimer = 0;\r\n\r\n    deliverCoinsFun(deltaTime: number) {\r\n        const backpack1 = this.node.getChildByName(\"Backpack1\");\r\n        if (!backpack1 || backpack1.children.length === 0) return;\r\n        if (!this.otherNode) return;\r\n\r\n        var deliveryAreaNames = [];\r\n        for (var key in CollisionEntityEnum) {\r\n            if (CollisionEntityEnum.hasOwnProperty(key)) {\r\n                deliveryAreaNames.push(CollisionEntityEnum[key]);\r\n            }\r\n        }\r\n\r\n        if (deliveryAreaNames.indexOf(this.otherNode.name) === -1) return;\r\n\r\n        const plot = this.otherNode.getChildByName(\"Plot\");\r\n        const deliveryNumNode = plot?.getChildByName(\"DeliveryNum\");\r\n        const label = deliveryNumNode?.getComponent(Label);\r\n        const isNotZeroScale = plot?.scale.x !== 0 || plot.scale.y !== 0 || plot.scale.z !== 0;\r\n\r\n        if (!plot || !deliveryNumNode || !label || !isNotZeroScale) return;\r\n\r\n        // \r\n        let total = this.deliveryCountMap.get(this.otherNode);\r\n        if (total === undefined) {\r\n            total = Number(label.string);\r\n            this.deliveryCountMap.set(this.otherNode, total);\r\n            this.pendingDeliveryCountMap.set(this.otherNode, 0);\r\n        }\r\n\r\n        const pending = this.pendingDeliveryCountMap.get(this.otherNode) ?? 0;\r\n        if (total - pending <= 0) return; // \r\n\r\n        this._deliverTimer += deltaTime;\r\n        if (this._deliverTimer < this._deliverInterval) return;\r\n        this._deliverTimer = 0;\r\n\r\n        const success = this.deliverItemToTarget(this.otherNode);\r\n        if (!success) return;\r\n    }\r\n\r\n    private deliverItemToTarget(targetNode: Node): boolean {\r\n        const player = DataManager.Instance.player;\r\n        const backpack1 = player?.node?.getChildByName(\"Backpack1\");\r\n        if (!player || !backpack1 || backpack1.children.length === 0) return false;\r\n\r\n        const item = backpack1.children[backpack1.children.length - 1];\r\n        if (!item || !item.isValid) return false;\r\n\r\n        const plot = targetNode.getChildByName(\"Plot\");\r\n        const deliveryNumNode = plot?.getChildByName(\"DeliveryNum\");\r\n        const label = deliveryNumNode?.getComponent(Label);\r\n        if (!plot || !deliveryNumNode || !label) return false;\r\n\r\n        const currentTotal = this.deliveryCountMap.get(targetNode) ?? Number(label.string);\r\n        const currentPending = this.pendingDeliveryCountMap.get(targetNode) ?? 0;\r\n        if (currentTotal - currentPending <= 0) return false;\r\n\r\n        // \r\n        this.pendingDeliveryCountMap.set(targetNode, currentPending + 1);\r\n\r\n        // UI\r\n        const iconSprite = plot.getChildByName(\"Icon\");\r\n        if (iconSprite) {\r\n            tween(iconSprite).stop();\r\n            tween(iconSprite)\r\n                .to(0.1, { scale: new Vec3(0.02, 0.02, 0.02) })\r\n                .to(0.1, { scale: new Vec3(0.015, 0.015, 0.015) })\r\n                .start();\r\n        }\r\n\r\n        const deliveryNumSprite = plot.getChildByName(\"DeliveryNum\");\r\n        if (deliveryNumSprite) {\r\n            tween(deliveryNumSprite).stop();\r\n            tween(deliveryNumSprite)\r\n                .to(0.1, { scale: new Vec3(0.08, 0.08, 0.08) })\r\n                .to(0.1, { scale: new Vec3(0.06, 0.06, 0.06) })\r\n                .start();\r\n        }\r\n\r\n        // \r\n        const itemWorldPos = item.worldPosition.clone();\r\n        item.setParent(this.node.parent);\r\n\r\n        const start = itemWorldPos;\r\n        const end = targetNode.worldPosition.clone();\r\n        const control = new Vec3(\r\n            (start.x + end.x) / 2,\r\n            Math.max(start.y, end.y) + 7,\r\n            (start.z + end.z) / 2\r\n        );\r\n\r\n        const controller = { t: 0 };\r\n        tween(controller)\r\n            .to(0.5, { t: 1 }, {\r\n                easing: 'quadInOut',\r\n                onUpdate: () => {\r\n                    const t = controller.t;\r\n                    const oneMinusT = 1 - t;\r\n                    const pos = new Vec3(\r\n                        oneMinusT * oneMinusT * start.x + 2 * oneMinusT * t * control.x + t * t * end.x,\r\n                        oneMinusT * oneMinusT * start.y + 2 * oneMinusT * t * control.y + t * t * end.y,\r\n                        oneMinusT * oneMinusT * start.z + 2 * oneMinusT * t * control.z + t * t * end.z\r\n                    );\r\n                    item.setWorldPosition(pos);\r\n                }\r\n            })\r\n            .call(() => {\r\n                DataManager.Instance.monsterManager.recycleDrop(item);\r\n                DataManager.Instance.soundManager.playIconSound();\r\n\r\n                //  UI\r\n                let remaining = this.deliveryCountMap.get(targetNode) ?? 1;\r\n                remaining = Math.max(remaining - 1, 0);\r\n                this.deliveryCountMap.set(targetNode, remaining);\r\n                label.string = remaining.toString();\r\n                DataManager.Instance.UIPropertyManager.deliverProperty();\r\n\r\n                let pending = this.pendingDeliveryCountMap.get(targetNode) ?? 1;\r\n                this.pendingDeliveryCountMap.set(targetNode, Math.max(pending - 1, 0));\r\n\r\n                if (remaining === 0 && !(targetNode as any)._hasDeliveredZero) {\r\n                    (targetNode as any)._hasDeliveredZero = true;\r\n                    this.onDeliveryComplete(targetNode);\r\n                }\r\n            })\r\n            .start();\r\n\r\n        return true;\r\n    }\r\n\r\n    // \r\n    onTriggerExit(event: ICollisionEvent) {\r\n        DataManager.Instance.isInWeaponDeliveryArea = false;\r\n        const otherCollider = event.otherCollider;\r\n        const selfCollider = event.selfCollider;\r\n        const otherNode = event.otherCollider.node;\r\n\r\n        if (otherNode.name == \"ObtainEquipmentArea\") {\r\n            this.isWeaponArea = false;\r\n            this._weaponCollecting = false;\r\n        }\r\n        if (otherCollider.node.name.includes(\"Door\")) {\r\n            const [scene, side] = otherCollider.node.name.split(\"_\");\r\n\r\n            const sceneMap = {\r\n                Scene1: {\r\n                    L: this.scene1LSide,\r\n                    T: this.scene1TSide,\r\n                    B: this.scene1BSide,\r\n                    R: this.scene1RSide\r\n                },\r\n                Scene2: {\r\n                    L: this.scene2LSide,\r\n                    T: this.scene2TSide,\r\n                    B: this.scene2BSide,\r\n                    R: this.scene2RSide\r\n                }\r\n            };\r\n\r\n            const doorGroup = sceneMap[scene]?.[side]?.getChildByName(`${side}_Door`);\r\n            if (!doorGroup) {\r\n                console.warn(`[Door] ${scene}_${side} `);\r\n                return;\r\n            }\r\n\r\n            const doorL = doorGroup.getChildByName(\"Door_Left\");\r\n            const doorR = doorGroup.getChildByName(\"Door_Right\");\r\n\r\n            this.closeDoorBySide(doorL, doorR, side);\r\n        }\r\n\r\n        // \r\n        var deliveryAreaNames = [];\r\n        for (var key in CollisionEntityEnum) {\r\n            if (CollisionEntityEnum.hasOwnProperty(key)) {\r\n                deliveryAreaNames.push(CollisionEntityEnum[key]);\r\n            }\r\n        }\r\n\r\n        if (deliveryAreaNames.indexOf(otherNode.name) !== -1) {\r\n            this.isDeliverCoins = false;\r\n            this.otherNode = null;\r\n        }\r\n\r\n    }\r\n\r\n    closeDoorBySide(doorL: Node | null, doorR: Node | null, side: string, isMinion = false) {\r\n        const duration = 0.3;\r\n\r\n        const angleMap = {\r\n            L: { left: 180, right: 180 },\r\n            R: { left: 0, right: 0 },\r\n            T: { left: 90, right: 90 },\r\n            B: { left: -90, right: -90 }\r\n        };\r\n\r\n        const config = angleMap[side];\r\n        if (!config) {\r\n            console.warn(`[Door] : ${side}`);\r\n            return;\r\n        }\r\n\r\n        if (this.node.name == \"Player\" && !DataManager.Instance.isAllMinionsPassed && side == \"B\" && !isMinion) {\r\n            return;\r\n        }\r\n\r\n        if (doorL?.isValid) {\r\n            tween(doorL)\r\n                .to(duration, { eulerAngles: new Vec3(0, config.left, 0) }, { easing: 'quadOut' })\r\n                .start();\r\n        }\r\n\r\n        if (doorR?.isValid) {\r\n            tween(doorR)\r\n                .to(duration, { eulerAngles: new Vec3(0, config.right, 0) }, { easing: 'quadOut' })\r\n                .start();\r\n        }\r\n    }\r\n\r\n    onDeliveryComplete(otherNode) {\r\n        const plot = otherNode.getChildByName(\"Plot\");\r\n        const buildingCon = otherNode.getChildByName(\"BuildingCon\");\r\n        if (!plot) return;\r\n\r\n        const uiOpacity = plot.getComponent(UIOpacity) || plot.addComponent(UIOpacity);\r\n        tween(uiOpacity)\r\n            .to(0.3, { opacity: 0 })\r\n            .call(() => {\r\n                DataManager.Instance.soundManager.BuildingUnlockSoundPlay();\r\n\r\n                const data = DataManager.Instance.guideTargetList.find(item => {\r\n                    return item.name == otherNode.name;\r\n                })\r\n\r\n                if (data) {\r\n                    data.isFind = false;\r\n                    data.isDisplay = false;\r\n                }\r\n\r\n                if (otherNode.name == \"DeliveryAreas3\" || otherNode.name == \"DeliveryAreas4\" ||\r\n                    otherNode.name == \"DeliveryAreas5\" || otherNode.name == \"DeliveryAreas8\" ||\r\n                    otherNode.name == \"DeliveryAreas7\") {\r\n                    buildingCon.setScale(1, 1, 0);\r\n                    tween(buildingCon)\r\n                        .to(0.15, { scale: new Vec3(1, 1, 1.1) }, { easing: 'quadOut' }) // \r\n                        .to(0.05, { scale: new Vec3(1, 1, 1) }, { easing: 'quadOut' })\r\n                        .call(() => {\r\n                            const deliveryAreasPh = find(PathEnum.DeliveryAreasPh);\r\n                            if (deliveryAreasPh) {\r\n                                const deliveryAreas = deliveryAreasPh.getChildByName(otherNode.name);\r\n                                if (deliveryAreas) {\r\n                                    const boxCollider = deliveryAreas.getComponent(BoxCollider);\r\n                                    if (boxCollider) {\r\n                                        boxCollider.enabled = true;\r\n                                    }\r\n\r\n                                    const rigidbody = deliveryAreas.getComponent(RigidBody);\r\n                                    if (rigidbody) {\r\n                                        rigidbody.enabled = true;\r\n                                        rigidbody.wakeUp();\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            // \r\n                            this.unlockNewSpecies(otherNode);\r\n                        })\r\n                        .start();\r\n                } else {\r\n                    buildingCon.setScale(1, 0, 1);\r\n                    tween(buildingCon)\r\n                        .to(0.15, { scale: new Vec3(1, 1.1, 1) }, { easing: 'quadOut' }) // \r\n                        .to(0.05, { scale: new Vec3(1, 1, 1) }, { easing: 'quadOut' })\r\n                        .call(() => {\r\n                            const deliveryAreasPh = find(PathEnum.DeliveryAreasPh);\r\n                            if (deliveryAreasPh) {\r\n                                const deliveryAreas = deliveryAreasPh.getChildByName(otherNode.name);\r\n                                if (deliveryAreas) {\r\n                                    const boxCollider = deliveryAreas.getComponent(BoxCollider);\r\n                                    if (boxCollider) {\r\n                                        boxCollider.enabled = true;\r\n                                    }\r\n\r\n                                    const rigidbody = deliveryAreas.getComponent(RigidBody);\r\n                                    if (rigidbody) {\r\n                                        rigidbody.enabled = true;\r\n                                        rigidbody.wakeUp();\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            // \r\n                            this.unlockNewSpecies(otherNode);\r\n                        })\r\n                        .start();\r\n                }\r\n            })\r\n            .start()\r\n    }\r\n\r\n    // \r\n    unlockNewSpecies(otherNode) {\r\n        // 6\r\n        if (otherNode.name == CollisionEntityEnum.DeliveryAreas3 || otherNode.name == CollisionEntityEnum.DeliveryAreas4 ||\r\n            otherNode.name == CollisionEntityEnum.DeliveryAreas5) {\r\n            if (this.isUnlockDeliveryAreas6) {\r\n                this.isUnlockDeliveryAreas6 = false;\r\n\r\n                const deliveryAreas6 = otherNode.parent.getChildByName(CollisionEntityEnum.DeliveryAreas6);\r\n                if (deliveryAreas6) {\r\n                    const plot = deliveryAreas6.getChildByName(\"Plot\");\r\n                    const itemAreaManager7 = deliveryAreas6.getComponent(ItemAreaManager);\r\n                    itemAreaManager7?.displayAni(plot);\r\n\r\n                    const data = DataManager.Instance.guideTargetList.find(item => {\r\n                        return item.name == CollisionEntityEnum.DeliveryAreas6;\r\n                    })\r\n\r\n                    if (data) {\r\n                        data.isFind = true;\r\n                        data.isDisplay = true;\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n        // \r\n        if (otherNode.name == CollisionEntityEnum.DeliveryAreas3 || otherNode.name == CollisionEntityEnum.DeliveryAreas4 ||\r\n            otherNode.name == CollisionEntityEnum.DeliveryAreas5 || otherNode.name == CollisionEntityEnum.DeliveryAreas8) {\r\n            // \r\n            DataManager.Instance.cardConManager.createCards(otherNode);\r\n        } else if (otherNode.name == CollisionEntityEnum.DeliveryAreas6) {             // 1\r\n            // 1 \r\n            const fencesScene1 = find(PathEnum.FencesScene1);\r\n            const scene1RSide = fencesScene1.getChildByName(\"RSide\");\r\n            scene1RSide.active = false;\r\n\r\n            const scene1PhysicsRight = find(PathEnum.Scene1PhysicsRight);\r\n            for (let i = 0; i < scene1PhysicsRight.children.length; i++) {\r\n                const node = scene1PhysicsRight.children[i];\r\n                const boxCollider = node.getComponent(BoxCollider);\r\n                boxCollider.enabled = false;\r\n\r\n                const rigidBody = node.getComponent(RigidBody);\r\n                rigidBody.enabled = false;\r\n            }\r\n\r\n            // 2\r\n            let sideList: Node[] = [];\r\n            sideList.push(...this.scene2TSide.children, ...this.scene2RSide.children, ...this.scene2BSide.children.reverse());\r\n\r\n            // \r\n            for (let i = 0; i < sideList.length; i++) {\r\n                const node = sideList[i];\r\n                if (node.name.includes(\"Door\")) {\r\n                    const doorLeft = node.getChildByName(\"Door_Left\")\r\n                    const childrenL = doorLeft.children[0].children[0];\r\n                    const meshRendererL = childrenL.getComponent(MeshRenderer);\r\n                    meshRendererL.shadowCastingMode = 1;\r\n\r\n                    const doorRight = node.getChildByName(\"Door_Left\")\r\n                    const childrenR = doorRight.children[0].children[0];\r\n                    const meshRendererR = childrenR.getComponent(MeshRenderer);\r\n                    meshRendererR.shadowCastingMode = 1;\r\n                } else {\r\n                    const children = node.children[0];\r\n                    const meshRender = children.getComponent(MeshRenderer);\r\n                    meshRender.shadowCastingMode = 1;\r\n                }\r\n\r\n                if ((node as any)._hasFadedIn) continue;\r\n                (node as any)._hasFadedIn = true;\r\n                // \r\n                const originPos = node.getPosition();\r\n\r\n                // \r\n                const targetPos = new Vec3(originPos.x, 0, originPos.z);\r\n\r\n                // \r\n                this.scheduleOnce(() => {\r\n                    tween(node)\r\n                        .to(0.2, { position: targetPos }, { easing: 'quadOut' })\r\n                        .call(() => {\r\n                            // \r\n                            if (i === sideList.length - 1) {\r\n                                const plane2 = find(\"Dixing/Plane-002\");\r\n                                if (plane2) {\r\n                                    plane2.active = true;\r\n                                    const palne02Ani = plane2.getComponent(Animation);\r\n                                    if (palne02Ani) {\r\n                                        palne02Ani.play(\"Plane02CS\")\r\n                                    }\r\n                                    // this.showPlane(plane2);\r\n                                }\r\n\r\n                                const deliveryAreas8 = otherNode.parent.getChildByName(CollisionEntityEnum.DeliveryAreas8);\r\n                                if (deliveryAreas8) {\r\n                                    const plot = deliveryAreas8.getChildByName(\"Plot\");\r\n                                    const itemAreaManager8 = deliveryAreas8.getComponent(ItemAreaManager);\r\n                                    itemAreaManager8?.displayAni(plot);\r\n\r\n                                    const data = DataManager.Instance.guideTargetList.find(item => {\r\n                                        return item.name == CollisionEntityEnum.DeliveryAreas8\r\n                                    })\r\n\r\n                                    if (data) {\r\n                                        data.isFind = true;\r\n                                        data.isDisplay = true;\r\n                                    }\r\n                                }\r\n\r\n                                const deliveryAreas7 = otherNode.parent.getChildByName(CollisionEntityEnum.DeliveryAreas7);\r\n                                if (deliveryAreas7) {\r\n                                    const plot = deliveryAreas7.getChildByName(\"Plot\");\r\n                                    const itemAreaManager7 = deliveryAreas7.getComponent(ItemAreaManager);\r\n                                    itemAreaManager7?.displayAni(plot);\r\n\r\n                                    const data = DataManager.Instance.guideTargetList.find(item => {\r\n                                        return item.name == CollisionEntityEnum.DeliveryAreas7\r\n                                    })\r\n\r\n                                    if (data) {\r\n                                        data.isFind = true;\r\n                                        data.isDisplay = true;\r\n                                    }\r\n                                }\r\n\r\n                                // 2\r\n                                this.displaySceneTwoPath();\r\n\r\n                                // 2\r\n                                this.displaySceneRigidBody(PathEnum.Scene2Physics);\r\n\r\n                                // 2\r\n                                this.addSceneToObstacle(PathEnum.Scene2Physics);\r\n\r\n                                // \r\n                                DataManager.Instance.sceneManager.addSceneDoorFun(PathEnum.Scene2);\r\n\r\n                                // \r\n                                const monsters = DataManager.Instance.monsterManager.getSurroundedMonsters();\r\n                                if (monsters.length > 0) {\r\n                                    // \r\n                                    for (let i = 0; i < monsters.length; i++) {\r\n                                        const node = monsters[i];\r\n                                        if (!node || !node.isValid) continue;\r\n\r\n                                        if (node.name == \"Mantis\") {\r\n                                            // \r\n                                            for (let j = 0; j < 5; j++) {\r\n                                                DataManager.Instance.monsterManager.killMonsters([node])\r\n                                            }\r\n                                        } else {\r\n                                            for (let j = 0; j < 3; j++) {\r\n                                                DataManager.Instance.monsterManager.killMonsters([node]);\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n\r\n                                const fencesScene2 = find(PathEnum.FencesScene2);\r\n                                DataManager.Instance.sceneManager.collectGuardrails(fencesScene2);\r\n                            }\r\n                        })\r\n                        .start();\r\n                }, i * 0.05); // 0.05\r\n            }\r\n        } else if (otherNode.name == CollisionEntityEnum.DeliveryAreas7) {             // \r\n            // const deliveryAreas7 = otherNode.parent.getChildByName(CollisionEntityEnum.DeliveryAreas7);\r\n            // if (deliveryAreas7) {\r\n            //     const buildingCon = deliveryAreas7.getChildByName(\"BuildingCon\");\r\n            //     buildingCon.setScale(1, 1, 0);\r\n            //     tween(buildingCon)\r\n            //         .to(0.3, { scale: new Vec3(1, 1, 1.1) }, { easing: 'backOut' })\r\n            //         .to(0.3, { scale: new Vec3(1, 1, 1) }, { easing: 'backOut' })\r\n            //         .call(() => {\r\n            //             // \r\n            DataManager.Instance.isGenerateWeapons = true;\r\n\r\n            const data = DataManager.Instance.guideTargetList.find(item => {\r\n                return item.name == \"ObtainEquipmentArea\";\r\n            })\r\n\r\n            if (data) {\r\n                data.isFind = true;\r\n                data.isDisplay = true;\r\n            }\r\n            // })\r\n            // .start();\r\n            // const itemAreaManager7 = deliveryAreas7.getComponent(ItemAreaManager);\r\n            // itemAreaManager7?.displayAni(buildingCon);\r\n            // }\r\n        } else if (otherNode.name == CollisionEntityEnum.DeliveryAreas10) {            // 2  \r\n            // 2 \r\n            const fencesScene1 = find(PathEnum.FencesScene1);\r\n            const scene1RSide = fencesScene1.getChildByName(\"RSide\");\r\n            scene1RSide.active = false;\r\n\r\n            const scene1PhysicsRight = find(PathEnum.Scene2PhysicsRight);\r\n            for (let i = 0; i < scene1PhysicsRight.children.length; i++) {\r\n                const node = scene1PhysicsRight.children[i];\r\n                const boxCollider = node.getComponent(BoxCollider);\r\n                boxCollider.enabled = false;\r\n\r\n                const rigidBody = node.getComponent(RigidBody);\r\n                rigidBody.enabled = false;\r\n            }\r\n\r\n            const fencesScene2 = find(PathEnum.FencesScene2);\r\n            const scene2RSide = fencesScene2.getChildByName(\"RSide\");\r\n            scene2RSide.active = false;\r\n\r\n            const fencesScene3 = find(PathEnum.FencesScene3);\r\n            const tSide = fencesScene3.getChildByName(\"TSide\");\r\n            const rSide = fencesScene3.getChildByName(\"RSide\");\r\n            const bSide = fencesScene3.getChildByName(\"BSide\");\r\n\r\n            let newList = [];\r\n            newList.push(...tSide.children, ...rSide.children, ...bSide.children);\r\n\r\n            for (let i = 0; i < newList.length; i++) {\r\n                const node = newList[i];\r\n\r\n                if ((node as any)._hasFadedIn) continue;\r\n                (node as any)._hasFadedIn = true;\r\n\r\n                // \r\n                const originPos = node.getPosition();\r\n                const targetPos = new Vec3(originPos.x, 0, originPos.z);\r\n\r\n                // \r\n                this.scheduleOnce(() => {\r\n                    tween(node)\r\n                        .to(0.2, { position: targetPos }, { easing: 'quadOut' })\r\n                        .call(() => {\r\n                            if (i === newList.length - 1) {\r\n                                const plane3 = find(\"Dixing/Plane-003\");\r\n                                if (plane3) {\r\n                                    plane3.active = true;\r\n                                    const palne03Ani = plane3.getComponent(Animation);\r\n                                    if (palne03Ani) {\r\n                                        palne03Ani.play(\"Plane003CS\")\r\n                                    }\r\n                                    // this.showPlane(plane3);\r\n                                }\r\n                                // 2\r\n                                this.displaySceneRigidBody(PathEnum.Scene3Physics);\r\n\r\n                                // 2\r\n                                this.addSceneToObstacle(PathEnum.Scene3Physics);\r\n\r\n                                // \r\n                                DataManager.Instance.sceneManager.addSceneDoorFun(PathEnum.Scene3);\r\n\r\n                                // \r\n                                const monsters = DataManager.Instance.monsterManager.getSurroundedMonsters();\r\n                                if (monsters.length > 0) {\r\n                                    for (let i = 0; i < monsters.length; i++) {\r\n                                        const node = monsters[i];\r\n                                        if (!node || !node.isValid) continue;\r\n\r\n                                        if (node.name == \"Mantis\") {\r\n                                            // \r\n                                            for (let j = 0; j < 5; j++) {\r\n                                                DataManager.Instance.monsterManager.killMonsters([node])\r\n                                            }\r\n                                        } else {\r\n                                            DataManager.Instance.monsterManager.killMonsters([node]);\r\n                                        }\r\n                                    }\r\n                                }\r\n\r\n                                const fencesScene3 = find(PathEnum.FencesScene3);\r\n                                DataManager.Instance.sceneManager.collectGuardrails(fencesScene3);\r\n\r\n                                // \r\n                                if (DataManager.Instance.isGameEnd) return;\r\n\r\n                                this.scheduleOnce(() => {\r\n                                    DataManager.Instance.isGameEnd = true;\r\n\r\n                                    DataManager.Instance.gameEndManager.init();\r\n                                }, 2)\r\n                            }\r\n                        })\r\n                        .start();\r\n                }, i * 0.05); //  0.05s\r\n            }\r\n        } else if (otherNode.name == CollisionEntityEnum.DeliveryAreas9) {             // \r\n            DataManager.Instance.conveyerBeltManager.init();\r\n\r\n            this.scheduleOnce(() => {\r\n                // \r\n                DataManager.Instance.isConveyorBeltUnlocking = true;\r\n            }, 2)\r\n        } else if (otherNode.name == CollisionEntityEnum.DeliveryAreas1 ||\r\n            otherNode.name == CollisionEntityEnum.DeliveryAreas2) {\r\n            const buildingCon = otherNode.getChildByName(\"BuildingCon\");\r\n            if (buildingCon) {\r\n                const minion = buildingCon.getChildByName(\"Minion\");\r\n                if (minion) {\r\n                    const minionManager = minion.children[0].getComponent(MinionManager);\r\n\r\n                    if (minionManager) {\r\n                        minionManager.init();\r\n                        minionManager.changState(MinionStateEnum.Idle);\r\n\r\n                        const worldPos = minion.worldPosition;\r\n                        const effectPrafab = DataManager.Instance.prefabMap.get(EntityTypeEnum.TX_shengjiLZ);\r\n                        const skillExplosion = instantiate(effectPrafab);\r\n                        director.getScene().addChild(skillExplosion);\r\n                        skillExplosion.setWorldPosition(new Vec3(worldPos.x, worldPos.y + 1, worldPos.z));\r\n\r\n                        const anim = skillExplosion?.getComponent(Animation);\r\n                        if (anim) {\r\n                            anim.play(`TX_shengjiLZ`);\r\n                            anim.once(Animation.EventType.FINISHED, () => {\r\n                                skillExplosion.destroy();\r\n                            });\r\n                        } else {\r\n                            // \r\n                            this.scheduleOnce(() => {\r\n                                skillExplosion.destroy();\r\n                            }, 1);\r\n                        }\r\n\r\n                        tween(minion)\r\n                            .to(0.4, { scale: new Vec3(1, 1, 1) }, {\r\n                                easing: 'backOut' //  'elasticOut'\r\n                            })\r\n                            .call(() => {\r\n                                minionManager.isLookingForMonsters = true;\r\n                                minionManager.isMoveMinion = false;\r\n                            })\r\n                            .start();\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    fadeInMesh3D(node: Node, duration: number = 1.5) {\r\n        const meshRenderer = node.getComponent(MeshRenderer);\r\n        if (!meshRenderer) {\r\n            console.warn('[fadeInMesh3D]  MeshRenderer');\r\n            return;\r\n        }\r\n\r\n        const sharedMat = meshRenderer.material;\r\n        if (!sharedMat) {\r\n            console.warn('[fadeInMesh3D] ');\r\n            return;\r\n        }\r\n\r\n        //   effectAsset \r\n        const newMat = new Material();\r\n        newMat.initialize({\r\n            effectAsset: sharedMat.effectAsset,\r\n        });\r\n\r\n        //  \r\n        const pass = newMat.passes[0];\r\n        const blendTarget = pass.blendState.targets[0];\r\n        blendTarget.blend = true;\r\n        blendTarget.blendSrc = gfx.BlendFactor.SRC_ALPHA;\r\n        blendTarget.blendDst = gfx.BlendFactor.ONE_MINUS_SRC_ALPHA;\r\n        pass.blendState.targets[0] = blendTarget;\r\n\r\n        //  \r\n        const baseColor = new Color(163, 150, 0, 0);\r\n        const baseVec4 = new Vec4(\r\n            baseColor.r / 255,\r\n            baseColor.g / 255,\r\n            baseColor.b / 255,\r\n            0\r\n        );\r\n        newMat.setProperty('mainColor', baseVec4);\r\n\r\n        //  \r\n        meshRenderer.setMaterial(newMat, 0);\r\n\r\n        //  tween  -> \r\n        const fade = { alpha: 0 };\r\n        tween(fade)\r\n            .to(duration, { alpha: 1 }, {\r\n                onUpdate: () => {\r\n                    newMat.setProperty('mainColor', new Vec4(\r\n                        baseVec4.x, baseVec4.y, baseVec4.z, fade.alpha\r\n                    ));\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n\r\n    fadeInMaterial(node: Node, duration = 1.0) {\r\n        const renderer = node.getComponent(MeshRenderer);\r\n        if (!renderer) return;\r\n\r\n        const material = renderer.getMaterial(0);\r\n        if (!material) return;\r\n\r\n        // \r\n        const target = material.passes[0].blendState.targets[0];\r\n        target.blend = true;\r\n        target.blendSrc = 5; // src alpha\r\n        target.blendDst = 6; // one minus src alpha\r\n        target.blendEq = 0;\r\n\r\n        // \r\n        const color = new Color(255, 255, 255, 0);\r\n        material.setProperty('albedo', color); //  'albedo'\r\n\r\n        // Tween \r\n        const tempColor = color.clone();\r\n        tween(tempColor)\r\n            .to(duration, new Color(255, 255, 255, 255), {\r\n                onUpdate: () => {\r\n                    material.setProperty('albedo', tempColor);\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n\r\n    // 3\r\n    displayScene3RigidBody() {\r\n        const scene3Physics = find(PathEnum.Scene3Physics);\r\n        if (!scene3Physics) return;\r\n\r\n        for (let i = 0; i < scene3Physics.children.length; i++) {\r\n            const dirNode = scene3Physics.children[i];\r\n            if (!dirNode.activeInHierarchy) continue;\r\n\r\n            for (let j = 0; j < dirNode.children.length; j++) {\r\n                const node = dirNode.children[j];\r\n                if (!node || !node.activeInHierarchy) continue;\r\n\r\n                const boxColider = node.getComponent(BoxCollider);\r\n\r\n                if (boxColider) {\r\n                    boxColider.enabled = true;\r\n                }\r\n\r\n                const rigidBody = node.getComponent(RigidBody);\r\n\r\n                if (rigidBody) {\r\n                    rigidBody.enabled = true;\r\n                    rigidBody.wakeUp();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // \r\n    addSceneToObstacle(path) {\r\n        const scenePhysics = find(path)\r\n        for (let i = 0; i < scenePhysics.children.length; i++) {\r\n            const outNode = scenePhysics.children[i];\r\n            for (let j = 0; j < outNode.children.length; j++) {\r\n                const inNode = outNode.children[j];\r\n                if (inNode.name != \"Scene2_R_Door\") {\r\n                    RVOObstacles.addOneObstacle(inNode);\r\n                }\r\n            }\r\n        }\r\n\r\n        Simulator.instance.processObstacles();\r\n    }\r\n\r\n    // 2\r\n    displaySceneRigidBody(path) {\r\n        const scenePhysics = find(path);\r\n        if (!scenePhysics) return;\r\n\r\n        for (let i = 0; i < scenePhysics.children.length; i++) {\r\n            const dirNode = scenePhysics.children[i];\r\n            if (!dirNode.activeInHierarchy) continue;\r\n\r\n            for (let j = 0; j < dirNode.children.length; j++) {\r\n                const node = dirNode.children[j];\r\n                if (!node || !node.activeInHierarchy) continue;\r\n\r\n                const boxCollider = node.getComponent(BoxCollider);\r\n                const rigidBody = node.getComponent(RigidBody);\r\n\r\n                if (boxCollider) {\r\n                    boxCollider.enabled = true;\r\n                }\r\n\r\n                if (rigidBody) {\r\n                    rigidBody.enabled = true;\r\n                    rigidBody.wakeUp();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2\r\n    displaySceneTwoPath() {\r\n        let list = [];\r\n        const roadS2H = find(PathEnum.RoadS2H);\r\n        const roadS2S = find(PathEnum.RoadS2S);\r\n\r\n        list.push(...roadS2H.children.reverse(), ...roadS2S.children);\r\n\r\n        for (let i = 0; i < list.length; i++) {\r\n            tween(list[i])\r\n                .to(i * 0.1, { scale: new Vec3(1, 1, 1) })\r\n                .start();\r\n        }\r\n    }\r\n\r\n    // \r\n    getPlayerWeaponStep() {\r\n        if (!this.isWeaponArea) {\r\n            this._weaponCollecting = false;\r\n            return;\r\n        }\r\n\r\n        const deliveryAreas7 = find(PathEnum.DeliveryAreas7);\r\n        if (!deliveryAreas7) return;\r\n\r\n        const buildingCon = deliveryAreas7.getChildByName(\"BuildingCon\");\r\n        const weapons = buildingCon?.getChildByName(\"Weapons\");\r\n        if (!weapons || this._weaponCollectIndex < 0 || this._weaponCollectIndex >= weapons.children.length) {\r\n            this._weaponCollecting = false;\r\n            return;\r\n        }\r\n\r\n        const weapon = weapons.children[this._weaponCollectIndex];\r\n        this._weaponCollectIndex--;\r\n\r\n        if (!weapon || !weapon.isValid) return;\r\n\r\n        const backpack2 = DataManager.Instance.player.node.getChildByName(\"Backpack2\");\r\n        if (!backpack2) return;\r\n\r\n        const duration = 0.6;\r\n        const start = weapon.worldPosition.clone();\r\n        const controller = { t: 0 };\r\n\r\n        weapon.setParent(this.node.parent);\r\n        weapon.setWorldPosition(start);\r\n\r\n        this.playerWeaponRotationAni(weapon);\r\n\r\n        tween(controller)\r\n            .to(duration, { t: 1 }, {\r\n                easing: 'quadOut',\r\n                onUpdate: () => {\r\n                    const t = controller.t;\r\n                    const oneMinusT = 1 - t;\r\n\r\n                    let maxY = 0;\r\n                    for (let j = 0; j < backpack2.children.length; j++) {\r\n                        const child = backpack2.children[j];\r\n                        if (!child || !child.isValid) continue;\r\n                        const localPos = child.getPosition();\r\n                        if (localPos.y > maxY) {\r\n                            maxY = localPos.y;\r\n                        }\r\n                    }\r\n\r\n                    const localTarget = new Vec3(0, maxY + 0.5, 0);\r\n\r\n                    const worldPos = backpack2.getWorldPosition();\r\n                    const worldRot = backpack2.getWorldRotation();\r\n                    const worldScale = backpack2.getWorldScale();\r\n                    const worldMat = new Mat4();\r\n                    Mat4.fromRTS(worldMat, worldRot, worldPos, worldScale);\r\n\r\n                    const worldTarget = Vec3.transformMat4(new Vec3(), localTarget, worldMat);\r\n\r\n                    const control = new Vec3(\r\n                        (start.x + worldTarget.x) / 2,\r\n                        Math.max(start.y, worldTarget.y) + 2,\r\n                        (start.z + worldTarget.z) / 2\r\n                    );\r\n\r\n                    const pos = new Vec3(\r\n                        oneMinusT * oneMinusT * start.x + 2 * oneMinusT * t * control.x + t * t * worldTarget.x,\r\n                        oneMinusT * oneMinusT * start.y + 2 * oneMinusT * t * control.y + t * t * worldTarget.y,\r\n                        oneMinusT * oneMinusT * start.z + 2 * oneMinusT * t * control.z + t * t * worldTarget.z\r\n                    );\r\n\r\n                    weapon.setWorldPosition(pos);\r\n                }\r\n            })\r\n            .call(() => {\r\n                const finalWorldPos = weapon.getWorldPosition().clone();\r\n                weapon.setParent(backpack2);\r\n                weapon.setWorldPosition(finalWorldPos);\r\n\r\n                DataManager.Instance.soundManager.WeaponPickingUpSoundPlay();\r\n\r\n                if (this.onceData) {\r\n                    this.onceData = false;\r\n\r\n                    const data = DataManager.Instance.guideTargetList.find(item => {\r\n                        return item.name == \"ObtainEquipmentArea\";\r\n                    })\r\n\r\n                    if (data) {\r\n                        data.isFind = false;\r\n                        data.isDisplay = false;\r\n                    }\r\n\r\n                    const nextData = DataManager.Instance.guideTargetList.find(item => {\r\n                        return item.name == \"DeliverEquipmentArea\";\r\n                    })\r\n\r\n                    if (nextData) {\r\n                        nextData.isFind = true;\r\n                        nextData.isDisplay = true;\r\n                    }\r\n                }\r\n\r\n            })\r\n            .start();\r\n    }\r\n\r\n    // \r\n    playerWeaponRotationAni(weapon) {\r\n        const duration = 0.6;\r\n        // \r\n        const startEuler = weapon.children[0].eulerAngles.clone(); //  Vec3.ZERO\r\n        const targetEuler = new Vec3(123, -8, 180);\r\n        const rotCtrl = { t: 0 };\r\n\r\n        tween(rotCtrl)\r\n            .to(duration, { t: 1 }, {\r\n                easing: 'quadOut',\r\n                onUpdate: () => {\r\n                    const t = rotCtrl.t;\r\n                    const currentEuler = new Vec3();\r\n                    Vec3.lerp(currentEuler, startEuler, targetEuler, t);\r\n                    weapon.children[0].setRotationFromEuler(currentEuler.x, currentEuler.y, currentEuler.z);\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}