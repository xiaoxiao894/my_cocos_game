{"version":3,"sources":["file:///D:/Cocos/PlayAble/L_DefendTheCup/assets/JavaScript/Common/Platform.ts"],"names":["Platform","PlatformEnum","AdvChannels","storeIOS","storeANDROID","_lockStore","instance","_instance","init","jumpStore","AppLovin","Unity","test","navigator","userAgent","window","mraid","open","setTimeout","defaultJump","console","error","IronSource","dapi","openStoreUrl","Moloco","FbPlayableAd","onCTAClick","Google","ExitApi","exit","Facebook","Pangle","Tiktok","openAppStore","Vungle","parent","postMessage"],"mappings":"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","sourcesContent":["\r\n// @ts-nocheck\r\nimport { PlatformEnum } from \"../Enum\";\r\n\r\n\r\n//打包过程会重置这个值，变成平台类型\r\nexport const AdvChannels: string = '{{__adv_channels_adapter__}}';\r\nexport const storeIOS = \"https://play.google.com/store/apps/details?gl=US&hl=en-US&id=com.gzgroup.lproject3\";\r\nexport const storeANDROID = \"https://play.google.com/store/apps/details?gl=US&hl=en-US&id=com.gzgroup.lproject3\";\r\n\r\n// applovin google ironsource moloco unity\r\nexport default class Platform {\r\n\r\n    private _lockStore: boolean = false;\r\n\r\n    private static _instance: Platform = null;\r\n\r\n    public static get instance() {\r\n        if (!this._instance) {\r\n            this._instance = new Platform();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    public init() {\r\n        this._lockStore = false;\r\n        //this.launchPlayable();\r\n    }\r\n\r\n\r\n    // private launchPlayable () {\r\n\r\n    // }\r\n\r\n    /**\r\n     * 跳转\r\n     */\r\n    public jumpStore(): void {\r\n        // console.log(`平台：${AdvChannels} lockstore:${this._lockStore}`);\r\n        switch (AdvChannels) {\r\n            case PlatformEnum.AppLovin:\r\n            case PlatformEnum.Unity:\r\n                if (this._lockStore) return;\r\n                if (/android/i.test(navigator.userAgent)) {\r\n                    this._lockStore = true;\r\n                    window.mraid?.open(storeANDROID);\r\n                    setTimeout(() => {\r\n                        this._lockStore = false;\r\n                    }, 500)\r\n                } else {\r\n                    this._lockStore = true;\r\n\r\n                    window.mraid?.open(storeIOS);\r\n                    setTimeout(() => {\r\n                        this._lockStore = false;\r\n                    }, 500)\r\n                }\r\n                if(!window.mraid){\r\n                    this.defaultJump();\r\n                    console.error(`${AdvChannels}平台包 当前环境没有 mraid 环境`);\r\n                }\r\n                break;\r\n            case PlatformEnum.IronSource:\r\n                if (this._lockStore) return;\r\n                this._lockStore = true;\r\n                dapi?.openStoreUrl();\r\n                setTimeout(() => {\r\n                    this._lockStore = false;\r\n                }, 500);\r\n                if(!dapi){\r\n                    this.defaultJump();\r\n                    console.error(`${AdvChannels}平台包 当前环境没有 dapi 环境`);\r\n                }\r\n                break;\r\n            case PlatformEnum.Moloco:\r\n\r\n                if (typeof window.FbPlayableAd !== \"undefined\") {\r\n                    window.FbPlayableAd.onCTAClick();\r\n                } else {\r\n                    this.defaultJump();\r\n                    console.error(`${AdvChannels}平台包 当前环境没有 FbPlayableAd 环境`);\r\n                }\r\n                break;\r\n            case PlatformEnum.Google:\r\n                if (this._lockStore) return;\r\n                this._lockStore = true;\r\n                ExitApi?.exit();\r\n                setTimeout(()=> {\r\n                    this._lockStore = false;\r\n                }, 500);\r\n                if(!ExitApi){\r\n                    this.defaultJump();\r\n                    console.error(`${AdvChannels}平台包 当前环境没有 ExitApi 环境`);\r\n                }\r\n                break;\r\n            case PlatformEnum.Facebook:\r\n                if (window._lockStore) return;\r\n                window._lockStore = true;\r\n                setTimeout(function () {\r\n                    window._lockStore = false;\r\n                }, 500);\r\n\r\n                if (typeof window.FbPlayableAd !== \"undefined\") {\r\n                    window.FbPlayableAd.onCTAClick();\r\n                } else {\r\n                    this.defaultJump();\r\n                    console.error(`${AdvChannels}平台包 当前环境没有 FbPlayableAd 环境`);\r\n                }\r\n                break;\r\n            case PlatformEnum.Pangle:\r\n            case PlatformEnum.Tiktok:\r\n                if (window._lockStore) return;\r\n                window._lockStore = true;\r\n                setTimeout(function () {\r\n                    window._lockStore = false;\r\n                }, 500)\r\n                window.openAppStore();\r\n                \r\n                break;\r\n            case PlatformEnum.Vungle:\r\n                if (window._lockStore) return;\r\n                window._lockStore = true;\r\n                window.parent.postMessage('download', '*');\r\n                setTimeout(function () {\r\n                    window._lockStore = false;\r\n                }, 500)\r\n                break;\r\n            default:\r\n                this.defaultJump();\r\n                console.error(`${AdvChannels}平台未接入或接入有问题，请联系开发人员`);\r\n                break;\r\n\r\n        }\r\n    }\r\n\r\n    private defaultJump(){\r\n        window.open(/android/i.test(navigator.userAgent) ? storeANDROID : storeIOS, \"_blank\");\r\n    }\r\n\r\n}"]}